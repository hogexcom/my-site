(function(){"use strict";function getDefaultExportFromCjs(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var numeric1_2_6={},hasRequiredNumeric1_2_6;function requireNumeric1_2_6(){return hasRequiredNumeric1_2_6||(hasRequiredNumeric1_2_6=1,(function(exports$1){var numeric=exports$1;typeof globalThis<"u"&&(globalThis.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(n,e){var r,o,i,t;for(typeof e>"u"&&(e=15),i=.5,r=new Date;;){for(i*=2,t=i;t>3;t-=4)n(),n(),n(),n();for(;t>0;)n(),t--;if(o=new Date,o-r>e)break}for(t=i;t>3;t-=4)n(),n(),n(),n();for(;t>0;)n(),t--;return o=new Date,1e3*(3*i-1)/(o-r)},numeric._myIndexOf=(function(n){var e=this.length,r;for(r=0;r<e;++r)if(this[r]===n)return r;return-1}),numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(n){function e(i){if(i===0)return"0";if(isNaN(i))return"NaN";if(i<0)return"-"+e(-i);if(isFinite(i)){var t=Math.floor(Math.log(i)/Math.log(10)),u=i/Math.pow(10,t),c=u.toPrecision(numeric.precision);return parseFloat(c)===10&&(t++,u=1,c=u.toPrecision(numeric.precision)),parseFloat(c).toString()+"e"+t.toString()}return"Infinity"}var r=[];function o(i){var t;if(typeof i>"u")return r.push(Array(numeric.precision+8).join(" ")),!1;if(typeof i=="string")return r.push('"'+i+'"'),!1;if(typeof i=="boolean")return r.push(i.toString()),!1;if(typeof i=="number"){var u=e(i),c=i.toPrecision(numeric.precision),f=parseFloat(i.toString()).toString(),l=[u,c,f,parseFloat(c).toString(),parseFloat(f).toString()];for(t=1;t<l.length;t++)l[t].length<u.length&&(u=l[t]);return r.push(Array(numeric.precision+8-u.length).join(" ")+u),!1}if(i===null)return r.push("null"),!1;if(typeof i=="function"){r.push(i.toString());var a=!1;for(t in i)i.hasOwnProperty(t)&&(a?r.push(`,
`):r.push(`
{`),a=!0,r.push(t),r.push(`: 
`),o(i[t]));return a&&r.push(`}
`),!0}if(i instanceof Array){if(i.length>numeric.largeArray)return r.push("...Large Array..."),!0;var a=!1;for(r.push("["),t=0;t<i.length;t++)t>0&&(r.push(","),a&&r.push(`
 `)),a=o(i[t]);return r.push("]"),!0}r.push("{");var a=!1;for(t in i)i.hasOwnProperty(t)&&(a&&r.push(`,
`),a=!0,r.push(t),r.push(`: 
`),o(i[t]));return r.push("}"),!0}return o(n),r.join("")},numeric.parseDate=function(n){function e(r){if(typeof r=="string")return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var o=[],i;for(i=0;i<r.length;i++)o[i]=e(r[i]);return o}return e(n)},numeric.parseFloat=function(n){function e(r){if(typeof r=="string")return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var o=[],i;for(i=0;i<r.length;i++)o[i]=e(r[i]);return o}return e(n)},numeric.parseCSV=function(n){var e=n.split(`
`),r,o,i=[],t=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=function(v){return v.substr(0,v.length-1)},f=0;for(o=0;o<e.length;o++){var l=(e[o]+",").match(t),a;if(l.length>0){for(i[f]=[],r=0;r<l.length;r++)a=c(l[r]),u.test(a)?i[f][r]=parseFloat(a):i[f][r]=a;f++}}return i},numeric.toCSV=function(n){var e=numeric.dim(n),r,o,i,t,u;for(i=e[0],e[1],u=[],r=0;r<i;r++){for(t=[],o=0;o<i;o++)t[o]=n[r][o].toString();u[r]=t.join(", ")}return u.join(`
`)+`
`},numeric.getURL=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(),e},numeric.imageURL=function(n){function e(j){var w=j.length,b,d,M,x,S,p,_,F,V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",U="";for(b=0;b<w;b+=3)d=j[b],M=j[b+1],x=j[b+2],S=d>>2,p=((d&3)<<4)+(M>>4),_=((M&15)<<2)+(x>>6),F=x&63,b+1>=w?_=F=64:b+2>=w&&(F=64),U+=V.charAt(S)+V.charAt(p)+V.charAt(_)+V.charAt(F);return U}function r(j,w,b){typeof w>"u"&&(w=0),typeof b>"u"&&(b=j.length);var d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],M=-1,x=0;j.length;var S;for(S=w;S<b;S++)x=(M^j[S])&255,M=M>>>8^d[x];return M^-1}var o=n[0].length,i=n[0][0].length,t,u,c,f,l,a,v,s,m,h,y=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,i>>24&255,i>>16&255,i>>8&255,i&255,o>>24&255,o>>16&255,o>>8&255,o&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=r(y,12,29),y[29]=h>>24&255,y[30]=h>>16&255,y[31]=h>>8&255,y[32]=h&255,t=1,u=0,v=0;v<o;v++){for(v<o-1?y.push(0):y.push(1),l=3*i+1+(v===0)&255,a=3*i+1+(v===0)>>8&255,y.push(l),y.push(a),y.push(~l&255),y.push(~a&255),v===0&&y.push(0),s=0;s<i;s++)for(c=0;c<3;c++)l=n[c][v][s],l>255?l=255:l<0?l=0:l=Math.round(l),t=(t+l)%65521,u=(u+t)%65521,y.push(l);y.push(0)}return m=(u<<16)+t,y.push(m>>24&255),y.push(m>>16&255),y.push(m>>8&255),y.push(m&255),f=y.length-41,y[33]=f>>24&255,y[34]=f>>16&255,y[35]=f>>8&255,y[36]=f&255,h=r(y,37),y.push(h>>24&255),y.push(h>>16&255),y.push(h>>8&255),y.push(h&255),y.push(0),y.push(0),y.push(0),y.push(0),y.push(73),y.push(69),y.push(78),y.push(68),y.push(174),y.push(66),y.push(96),y.push(130),"data:image/png;base64,"+e(y)},numeric._dim=function(n){for(var e=[];typeof n=="object";)e.push(n.length),n=n[0];return e},numeric.dim=function(n){var e,r;return typeof n=="object"?(e=n[0],typeof e=="object"?(r=e[0],typeof r=="object"?numeric._dim(n):[n.length,e.length]):[n.length]):[]},numeric.mapreduce=function(n,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+`;
if(typeof x === "number") { var xi = x; `+n+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+n+`;
    xi = x[i-1];
    `+n+`;
}
if(i === 0) {
    xi = x[i];
    `+n+`
}
return accum;`)},numeric.mapreduce2=function(n,e){return Function("x",`var n = x.length;
var i,xi;
`+e+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+n+`;
}
return accum;`)},numeric.same=function g(n,e){var r,o;if(!(n instanceof Array)||!(e instanceof Array)||(o=n.length,o!==e.length))return!1;for(r=0;r<o;r++)if(n[r]!==e[r])if(typeof n[r]=="object"){if(!g(n[r],e[r]))return!1}else return!1;return!0},numeric.rep=function(n,e,r){typeof r>"u"&&(r=0);var o=n[r],i=Array(o),t;if(r===n.length-1){for(t=o-2;t>=0;t-=2)i[t+1]=e,i[t]=e;return t===-1&&(i[0]=e),i}for(t=o-1;t>=0;t--)i[t]=numeric.rep(n,e,r+1);return i},numeric.dotMMsmall=function(n,e){var r,o,i,t,u,c,f,l,a,v,s;for(t=n.length,u=e.length,c=e[0].length,f=Array(t),r=t-1;r>=0;r--){for(l=Array(c),a=n[r],i=c-1;i>=0;i--){for(v=a[u-1]*e[u-1][i],o=u-2;o>=1;o-=2)s=o-1,v+=a[o]*e[o][i]+a[s]*e[s][i];o===0&&(v+=a[0]*e[0][i]),l[i]=v}f[r]=l}return f},numeric._getCol=function(n,e,r){var o=n.length,i;for(i=o-1;i>0;--i)r[i]=n[i][e],--i,r[i]=n[i][e];i===0&&(r[0]=n[0][e])},numeric.dotMMbig=function(n,e){var r=numeric._getCol,o=e.length,i=Array(o),t=n.length,u=e[0].length,c=new Array(t),f,l=numeric.dotVV,a,v;for(--o,--t,a=t;a!==-1;--a)c[a]=Array(u);for(--u,a=u;a!==-1;--a)for(r(e,a,i),v=t;v!==-1;--v)f=n[v],c[v][a]=l(f,i);return c},numeric.dotMV=function(n,e){var r=n.length;e.length;var o,i=Array(r),t=numeric.dotVV;for(o=r-1;o>=0;o--)i[o]=t(n[o],e);return i},numeric.dotVM=function(n,e){var r,o,i,t,u,c,f;for(i=n.length,t=e[0].length,u=Array(t),o=t-1;o>=0;o--){for(c=n[i-1]*e[i-1][o],r=i-2;r>=1;r-=2)f=r-1,c+=n[r]*e[r][o]+n[f]*e[f][o];r===0&&(c+=n[0]*e[0][o]),u[o]=c}return u},numeric.dotVV=function(n,e){var r,o=n.length,i,t=n[o-1]*e[o-1];for(r=o-2;r>=1;r-=2)i=r-1,t+=n[r]*e[r]+n[i]*e[i];return r===0&&(t+=n[0]*e[0]),t},numeric.dot=function(n,e){var r=numeric.dim;switch(r(n).length*1e3+r(e).length){case 2002:return e.length<10?numeric.dotMMsmall(n,e):numeric.dotMMbig(n,e);case 2001:return numeric.dotMV(n,e);case 1002:return numeric.dotVM(n,e);case 1001:return numeric.dotVV(n,e);case 1e3:return numeric.mulVS(n,e);case 1:return numeric.mulSV(n,e);case 0:return n*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(n){var e,r,o,i=n.length,t=Array(i),u;for(e=i-1;e>=0;e--){for(u=Array(i),r=e+2,o=i-1;o>=r;o-=2)u[o]=0,u[o-1]=0;for(o>e&&(u[o]=0),u[e]=n[e],o=e-1;o>=1;o-=2)u[o]=0,u[o-1]=0;o===0&&(u[0]=0),t[e]=u}return t},numeric.getDiag=function(g){var n=Math.min(g.length,g[0].length),e,r=Array(n);for(e=n-1;e>=1;--e)r[e]=g[e][e],--e,r[e]=g[e][e];return e===0&&(r[0]=g[0][0]),r},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(n,e,r){typeof r>"u"&&(r="");var o=[],i,t=/\[i\]$/,u,c="",f=!1;for(i=0;i<n.length;i++)t.test(n[i])?(u=n[i].substring(0,n[i].length-3),c=u):u=n[i],u==="ret"&&(f=!0),o.push(u);return o[n.length]="_s",o[n.length+1]="_k",o[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(f?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+n.join(",")+`,_s,_k+1);
    return ret;
}
`+r+`
for(i=_n-1;i!==-1;--i) {
    `+e+`
}
return ret;`,Function.apply(null,o)},numeric.pointwise2=function(n,e,r){typeof r>"u"&&(r="");var o=[],i,t=/\[i\]$/,u,c="",f=!1;for(i=0;i<n.length;i++)t.test(n[i])?(u=n[i].substring(0,n[i].length-3),c=u):u=n[i],u==="ret"&&(f=!0),o.push(u);return o[n.length]="var _n = "+c+`.length;
var i`+(f?"":", ret = Array(_n)")+`;
`+r+`
for(i=_n-1;i!==-1;--i) {
`+e+`
}
return ret;`,Function.apply(null,o)},numeric._biforeach=(function g(n,e,r,o,i){if(o===r.length-1){i(n,e);return}var t,u=r[o];for(t=u-1;t>=0;t--)g(typeof n=="object"?n[t]:n,typeof e=="object"?e[t]:e,r,o+1,i)}),numeric._biforeach2=(function g(n,e,r,o,i){if(o===r.length-1)return i(n,e);var t,u=r[o],c=Array(u);for(t=u-1;t>=0;--t)c[t]=g(typeof n=="object"?n[t]:n,typeof e=="object"?e[t]:e,r,o+1,i);return c}),numeric._foreach=(function g(n,e,r,o){if(r===e.length-1){o(n);return}var i,t=e[r];for(i=t-1;i>=0;i--)g(n[i],e,r+1,o)}),numeric._foreach2=(function g(n,e,r,o){if(r===e.length-1)return o(n);var i,t=e[r],u=Array(t);for(i=t-1;i>=0;i--)u[i]=g(n[i],e,r+1,o);return u}),numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},(function(){var g,n;for(g=0;g<numeric.mathfuns2.length;++g)n=numeric.mathfuns2[g],numeric.ops2[n]=n;for(g in numeric.ops2)if(numeric.ops2.hasOwnProperty(g)){n=numeric.ops2[g];var e,r,o="";numeric.myIndexOf.call(numeric.mathfuns2,g)!==-1?(o="var "+n+" = Math."+n+`;
`,e=function(i,t,u){return i+" = "+n+"("+t+","+u+")"},r=function(i,t){return i+" = "+n+"("+i+","+t+")"}):(e=function(i,t,u){return i+" = "+t+" "+n+" "+u},numeric.opseq.hasOwnProperty(g+"eq")?r=function(i,t){return i+" "+n+"= "+t}:r=function(i,t){return i+" = "+i+" "+n+" "+t}),numeric[g+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),o),numeric[g+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),o),numeric[g+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),o),numeric[g]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+g+"VV, VS = numeric."+g+"VS, SV = numeric."+g+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+r("x","y")+`
}
return x;
`),numeric[n]=numeric[g],numeric[g+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),o),numeric[g+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),o),numeric[g+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+g+"eqV, S = numeric."+g+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(g=0;g<numeric.mathfuns2.length;++g)n=numeric.mathfuns2[g],delete numeric.ops2[n];for(g=0;g<numeric.mathfuns.length;++g)n=numeric.mathfuns[g],numeric.ops1[n]=n;for(g in numeric.ops1)numeric.ops1.hasOwnProperty(g)&&(o="",n=numeric.ops1[g],numeric.myIndexOf.call(numeric.mathfuns,g)!==-1&&Math.hasOwnProperty(n)&&(o="var "+n+" = Math."+n+`;
`),numeric[g+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",o),numeric[g+"eq"]=Function("x",'if(typeof x !== "object") return '+n+`x
var i;
var V = numeric.`+g+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[g+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",o),numeric[g]=Function("x",'if(typeof x !== "object") return '+n+`(x)
var i;
var V = numeric.`+g+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(g=0;g<numeric.mathfuns.length;++g)n=numeric.mathfuns[g],delete numeric.ops1[n];for(g in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(g)&&(n=numeric.mapreducers[g],numeric[g+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[g]=Function("x","s","k",n[1]+`if(typeof x !== "object") {    xi = x;
`+n[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+g+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+n[0]+`;
}
return accum;
`))})(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(n,e){return typeof n=="object"?typeof e=="object"?numeric.truncVV(n,e):numeric.truncVS(n,e):typeof e=="object"?numeric.truncSV(n,e):Math.round(n/e)*e},numeric.inv=function(h){var e=numeric.dim(h),r=Math.abs,o=e[0],i=e[1],t=numeric.clone(h),u,c,f=numeric.identity(o),l,a,v,s,m,h;for(s=0;s<i;++s){var y=-1,j=-1;for(v=s;v!==o;++v)m=r(t[v][s]),m>j&&(y=v,j=m);for(c=t[y],t[y]=t[s],t[s]=c,a=f[y],f[y]=f[s],f[s]=a,h=c[s],m=s;m!==i;++m)c[m]/=h;for(m=i-1;m!==-1;--m)a[m]/=h;for(v=o-1;v!==-1;--v)if(v!==s){for(u=t[v],l=f[v],h=u[s],m=s+1;m!==i;++m)u[m]-=c[m]*h;for(m=i-1;m>0;--m)l[m]-=a[m]*h,--m,l[m]-=a[m]*h;m===0&&(l[0]-=a[0]*h)}}return f},numeric.det=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var r=e[0],o=1,i,t,u,c=numeric.clone(n),f,l,a,v,s;for(t=0;t<r-1;t++){for(u=t,i=t+1;i<r;i++)Math.abs(c[i][t])>Math.abs(c[u][t])&&(u=i);for(u!==t&&(v=c[u],c[u]=c[t],c[t]=v,o*=-1),f=c[t],i=t+1;i<r;i++){for(l=c[i],a=l[t]/f[t],u=t+1;u<r-1;u+=2)s=u+1,l[u]-=f[u]*a,l[s]-=f[s]*a;u!==r&&(l[u]-=f[u]*a)}if(f[t]===0)return 0;o*=f[t]}return o*c[t][t]},numeric.transpose=function(n){var e,r,o=n.length,i=n[0].length,t=Array(i),u,c,f;for(r=0;r<i;r++)t[r]=Array(o);for(e=o-1;e>=1;e-=2){for(c=n[e],u=n[e-1],r=i-1;r>=1;--r)f=t[r],f[e]=c[r],f[e-1]=u[r],--r,f=t[r],f[e]=c[r],f[e-1]=u[r];r===0&&(f=t[0],f[e]=c[0],f[e-1]=u[0])}if(e===0){for(u=n[0],r=i-1;r>=1;--r)t[r][0]=u[r],--r,t[r][0]=u[r];r===0&&(t[0][0]=u[0])}return t},numeric.negtranspose=function(n){var e,r,o=n.length,i=n[0].length,t=Array(i),u,c,f;for(r=0;r<i;r++)t[r]=Array(o);for(e=o-1;e>=1;e-=2){for(c=n[e],u=n[e-1],r=i-1;r>=1;--r)f=t[r],f[e]=-c[r],f[e-1]=-u[r],--r,f=t[r],f[e]=-c[r],f[e-1]=-u[r];r===0&&(f=t[0],f[e]=-c[0],f[e-1]=-u[0])}if(e===0){for(u=n[0],r=i-1;r>=1;--r)t[r][0]=-u[r],--r,t[r][0]=-u[r];r===0&&(t[0][0]=-u[0])}return t},numeric._random=function g(n,e){var r,o=n[e],i=Array(o),t;if(e===n.length-1){for(t=Math.random,r=o-1;r>=1;r-=2)i[r]=t(),i[r-1]=t();return r===0&&(i[0]=t()),i}for(r=o-1;r>=0;r--)i[r]=g(n,e+1);return i},numeric.random=function(n){return numeric._random(n,0)},numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.linspace=function(n,e,r){if(typeof r>"u"&&(r=Math.max(Math.round(e-n)+1,1)),r<2)return r===1?[n]:[];var o,i=Array(r);for(r--,o=r;o>=0;o--)i[o]=(o*e+(r-o)*n)/r;return i},numeric.getBlock=function(n,e,r){var o=numeric.dim(n);function i(t,u){var c,f=e[u],l=r[u]-f,a=Array(l);if(u===o.length-1){for(c=l;c>=0;c--)a[c]=t[c+f];return a}for(c=l;c>=0;c--)a[c]=i(t[c+f],u+1);return a}return i(n,0)},numeric.setBlock=function(n,e,r,o){var i=numeric.dim(n);function t(u,c,f){var l,a=e[f],v=r[f]-a;if(f===i.length-1)for(l=v;l>=0;l--)u[l+a]=c[l];for(l=v;l>=0;l--)t(u[l+a],c[l],f+1)}return t(n,o,0),n},numeric.getRange=function(n,e,r){var o=e.length,i=r.length,t,u,c=Array(o),f,l;for(t=o-1;t!==-1;--t)for(c[t]=Array(i),f=c[t],l=n[e[t]],u=i-1;u!==-1;--u)f[u]=l[r[u]];return c},numeric.blockMatrix=function(n){var e=numeric.dim(n);if(e.length<4)return numeric.blockMatrix([n]);var r=e[0],o=e[1],i,t,u,c,f;for(i=0,t=0,u=0;u<r;++u)i+=n[u][0].length;for(c=0;c<o;++c)t+=n[0][c][0].length;var l=Array(i);for(u=0;u<i;++u)l[u]=Array(t);var a=0,v,s,m,h,y;for(u=0;u<r;++u){for(v=t,c=o-1;c!==-1;--c)for(f=n[u][c],v-=f[0].length,m=f.length-1;m!==-1;--m)for(y=f[m],s=l[a+m],h=y.length-1;h!==-1;--h)s[v+h]=y[h];a+=n[u][0].length}return l},numeric.tensor=function(n,e){if(typeof n=="number"||typeof e=="number")return numeric.mul(n,e);var r=numeric.dim(n),o=numeric.dim(e);if(r.length!==1||o.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var i=r[0],t=o[0],u=Array(i),c,f,l,a;for(f=i-1;f>=0;f--){for(c=Array(t),a=n[f],l=t-1;l>=3;--l)c[l]=a*e[l],--l,c[l]=a*e[l],--l,c[l]=a*e[l],--l,c[l]=a*e[l];for(;l>=0;)c[l]=a*e[l],--l;u[f]=c}return u},numeric.T=function(n,e){this.x=n,this.y=e},numeric.t=function(n,e){return new numeric.T(n,e)},numeric.Tbinop=function(n,e,r,o,i){if(numeric.indexOf,typeof i!="string"){var t;i="";for(t in numeric)numeric.hasOwnProperty(t)&&(n.indexOf(t)>=0||e.indexOf(t)>=0||r.indexOf(t)>=0||o.indexOf(t)>=0)&&t.length>1&&(i+="var "+t+" = numeric."+t+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+i+`
if(x.y) {  if(y.y) {    return new numeric.T(`+o+`);
  }
  return new numeric.T(`+r+`);
}
if(y.y) {
  return new numeric.T(`+e+`);
}
return new numeric.T(`+n+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var n=numeric.mul,e=numeric.div;if(this.y){var r=numeric.add(n(this.x,this.x),n(this.y,this.y));return new numeric.T(e(this.x,r),e(numeric.neg(this.y),r))}return new T(e(1,this.x))},numeric.T.prototype.div=function(n){if(n instanceof numeric.T||(n=new numeric.T(n)),n.y)return this.mul(n.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,n.x),e(this.y,n.x)):new numeric.T(e(this.x,n.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var n=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(n(e),n(r)):new numeric.T(n(e))},numeric.T.prototype.transjugate=function(){var n=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(n(e),numeric.negtranspose(r)):new numeric.T(n(e))},numeric.Tunop=function(n,e,r){return typeof r!="string"&&(r=""),Function(`var x = this;
`+r+`
if(x.y) {  `+e+`;
}
`+n+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var n=this;if(typeof n.y>"u")return new numeric.T(numeric.inv(n.x));var e=n.x.length,h,y,j,r=numeric.identity(e),o=numeric.rep([e,e],0),i=numeric.clone(n.x),t=numeric.clone(n.y),u,c,f,l,a,v,s,m,h,y,j,w,b,d,M,x,S,p;for(h=0;h<e;h++){for(d=i[h][h],M=t[h][h],w=d*d+M*M,j=h,y=h+1;y<e;y++)d=i[y][h],M=t[y][h],b=d*d+M*M,b>w&&(j=y,w=b);for(j!==h&&(p=i[h],i[h]=i[j],i[j]=p,p=t[h],t[h]=t[j],t[j]=p,p=r[h],r[h]=r[j],r[j]=p,p=o[h],o[h]=o[j],o[j]=p),u=i[h],c=t[h],a=r[h],v=o[h],d=u[h],M=c[h],y=h+1;y<e;y++)x=u[y],S=c[y],u[y]=(x*d+S*M)/w,c[y]=(S*d-x*M)/w;for(y=0;y<e;y++)x=a[y],S=v[y],a[y]=(x*d+S*M)/w,v[y]=(S*d-x*M)/w;for(y=h+1;y<e;y++){for(f=i[y],l=t[y],s=r[y],m=o[y],d=f[h],M=l[h],j=h+1;j<e;j++)x=u[j],S=c[j],f[j]-=x*d-S*M,l[j]-=S*d+x*M;for(j=0;j<e;j++)x=a[j],S=v[j],s[j]-=x*d-S*M,m[j]-=S*d+x*M}}for(h=e-1;h>0;h--)for(a=r[h],v=o[h],y=h-1;y>=0;y--)for(s=r[y],m=o[y],d=i[y][h],M=t[y][h],j=e-1;j>=0;j--)x=a[j],S=v[j],s[j]-=d*x-M*S,m[j]-=d*S+M*x;return new numeric.T(r,o)},numeric.T.prototype.get=function(n){var e=this.x,r=this.y,o=0,i,t=n.length;if(r){for(;o<t;)i=n[o],e=e[i],r=r[i],o++;return new numeric.T(e,r)}for(;o<t;)i=n[o],e=e[i],o++;return new numeric.T(e)},numeric.T.prototype.set=function(n,e){var r=this.x,o=this.y,i=0,t,u=n.length,c=e.x,f=e.y;if(u===0)return f?this.y=f:o&&(this.y=void 0),this.x=r,this;if(f){for(o||(o=numeric.rep(numeric.dim(r),0),this.y=o);i<u-1;)t=n[i],r=r[t],o=o[t],i++;return t=n[i],r[t]=c,o[t]=f,this}if(o){for(;i<u-1;)t=n[i],r=r[t],o=o[t],i++;return t=n[i],r[t]=c,c instanceof Array?o[t]=numeric.rep(numeric.dim(c),0):o[t]=0,this}for(;i<u-1;)t=n[i],r=r[t],i++;return t=n[i],r[t]=c,this},numeric.T.prototype.getRows=function(n,e){var r=e-n+1,o,i=Array(r),t,u=this.x,c=this.y;for(o=n;o<=e;o++)i[o-n]=u[o];if(c){for(t=Array(r),o=n;o<=e;o++)t[o-n]=c[o];return new numeric.T(i,t)}return new numeric.T(i)},numeric.T.prototype.setRows=function(n,e,r){var o,i=this.x,t=this.y,u=r.x,c=r.y;for(o=n;o<=e;o++)i[o]=u[o-n];if(c)for(t||(t=numeric.rep(numeric.dim(i),0),this.y=t),o=n;o<=e;o++)t[o]=c[o-n];else if(t)for(o=n;o<=e;o++)t[o]=numeric.rep([u[o-n].length],0);return this},numeric.T.prototype.getRow=function(n){var e=this.x,r=this.y;return r?new numeric.T(e[n],r[n]):new numeric.T(e[n])},numeric.T.prototype.setRow=function(n,e){var r=this.x,o=this.y,i=e.x,t=e.y;return r[n]=i,t?(o||(o=numeric.rep(numeric.dim(r),0),this.y=o),o[n]=t):o&&(o=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(n,e){var r=this.x,o=this.y,i=numeric.getBlock;return o?new numeric.T(i(r,n,e),i(o,n,e)):new numeric.T(i(r,n,e))},numeric.T.prototype.setBlock=function(n,e,r){r instanceof numeric.T||(r=new numeric.T(r));var o=this.x,i=this.y,t=numeric.setBlock,u=r.x,c=r.y;if(c)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),t(o,n,e,u),t(i,n,e,c),this;t(o,n,e,u),i&&t(i,n,e,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(n,e){var r=numeric.T;e instanceof r||(e=new r(e));var o=e.x,i=e.y,t=numeric.rep;return i?new r(t(n,o),t(n,i)):new r(t(n,o))},numeric.T.diag=function(n){n instanceof numeric.T||(n=new numeric.T(n));var e=n.x,r=n.y,o=numeric.diag;return r?new numeric.T(o(e),o(r)):new numeric.T(o(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,e=this.x,r=this.y;return r?new n.T(n.getDiag(e),n.getDiag(r)):new n.T(n.getDiag(e))},numeric.house=function(n){var e=numeric.clone(n),r=n[0]>=0?1:-1,o=r*numeric.norm2(n);e[0]+=o;var i=numeric.norm2(e);if(i===0)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r=e[0],o,i,t,u,c,f=numeric.clone(n),l,a,v,s,m=numeric.identity(r),h;for(i=0;i<r-2;i++){for(u=Array(r-i-1),o=i+1;o<r;o++)u[o-i-1]=f[o][i];if(numeric.norm2(u)>0){for(c=numeric.house(u),l=numeric.getBlock(f,[i+1,i],[r-1,r-1]),a=numeric.tensor(c,numeric.dot(c,l)),o=i+1;o<r;o++)for(v=f[o],s=a[o-i-1],t=i;t<r;t++)v[t]-=2*s[t-i];for(l=numeric.getBlock(f,[0,i+1],[r-1,r-1]),a=numeric.tensor(numeric.dot(l,c),c),o=0;o<r;o++)for(v=f[o],s=a[o],t=i+1;t<r;t++)v[t]-=2*s[t-i-1];for(l=Array(r-i-1),o=i+1;o<r;o++)l[o-i-1]=m[o];for(a=numeric.tensor(c,numeric.dot(c,l)),o=i+1;o<r;o++)for(h=m[o],s=a[o-i-1],t=0;t<r;t++)h[t]-=2*s[t]}}return{H:f,Q:m}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(g,n){typeof n>"u"&&(n=1e4),g=numeric.clone(g),numeric.clone(g);var e=numeric.dim(g),r=e[0],o,i,t,u,c,f,l,a,v,s=numeric.identity(r),m,h,y,j,w,b,d,M,x;if(r<3)return{Q:s,B:[[0,r-1]]};var S=numeric.epsilon;for(x=0;x<n;x++){for(d=0;d<r-1;d++)if(Math.abs(g[d+1][d])<S*(Math.abs(g[d][d])+Math.abs(g[d+1][d+1]))){var p=numeric.QRFrancis(numeric.getBlock(g,[0,0],[d,d]),n),_=numeric.QRFrancis(numeric.getBlock(g,[d+1,d+1],[r-1,r-1]),n);for(y=Array(d+1),b=0;b<=d;b++)y[b]=s[b];for(j=numeric.dot(p.Q,y),b=0;b<=d;b++)s[b]=j[b];for(y=Array(r-d-1),b=d+1;b<r;b++)y[b-d-1]=s[b];for(j=numeric.dot(_.Q,y),b=d+1;b<r;b++)s[b]=j[b-d-1];return{Q:s,B:p.B.concat(numeric.add(_.B,d+1))}}if(t=g[r-2][r-2],u=g[r-2][r-1],c=g[r-1][r-2],f=g[r-1][r-1],a=t+f,l=t*f-u*c,v=numeric.getBlock(g,[0,0],[2,2]),a*a>=4*l){var F,V;F=.5*(a+Math.sqrt(a*a-4*l)),V=.5*(a-Math.sqrt(a*a-4*l)),v=numeric.add(numeric.sub(numeric.dot(v,v),numeric.mul(v,F+V)),numeric.diag(numeric.rep([3],F*V)))}else v=numeric.add(numeric.sub(numeric.dot(v,v),numeric.mul(v,a)),numeric.diag(numeric.rep([3],l)));for(o=[v[0][0],v[1][0],v[2][0]],i=numeric.house(o),y=[g[0],g[1],g[2]],j=numeric.tensor(i,numeric.dot(i,y)),b=0;b<3;b++)for(h=g[b],w=j[b],M=0;M<r;M++)h[M]-=2*w[M];for(y=numeric.getBlock(g,[0,0],[r-1,2]),j=numeric.tensor(numeric.dot(y,i),i),b=0;b<r;b++)for(h=g[b],w=j[b],M=0;M<3;M++)h[M]-=2*w[M];for(y=[s[0],s[1],s[2]],j=numeric.tensor(i,numeric.dot(i,y)),b=0;b<3;b++)for(m=s[b],w=j[b],M=0;M<r;M++)m[M]-=2*w[M];var U;for(d=0;d<r-2;d++){for(M=d;M<=d+1;M++)if(Math.abs(g[M+1][M])<S*(Math.abs(g[M][M])+Math.abs(g[M+1][M+1]))){var p=numeric.QRFrancis(numeric.getBlock(g,[0,0],[M,M]),n),_=numeric.QRFrancis(numeric.getBlock(g,[M+1,M+1],[r-1,r-1]),n);for(y=Array(M+1),b=0;b<=M;b++)y[b]=s[b];for(j=numeric.dot(p.Q,y),b=0;b<=M;b++)s[b]=j[b];for(y=Array(r-M-1),b=M+1;b<r;b++)y[b-M-1]=s[b];for(j=numeric.dot(_.Q,y),b=M+1;b<r;b++)s[b]=j[b-M-1];return{Q:s,B:p.B.concat(numeric.add(_.B,M+1))}}for(U=Math.min(r-1,d+3),o=Array(U-d),b=d+1;b<=U;b++)o[b-d-1]=g[b][d];for(i=numeric.house(o),y=numeric.getBlock(g,[d+1,d],[U,r-1]),j=numeric.tensor(i,numeric.dot(i,y)),b=d+1;b<=U;b++)for(h=g[b],w=j[b-d-1],M=d;M<r;M++)h[M]-=2*w[M-d];for(y=numeric.getBlock(g,[0,d+1],[r-1,U]),j=numeric.tensor(numeric.dot(y,i),i),b=0;b<r;b++)for(h=g[b],w=j[b],M=d+1;M<=U;M++)h[M]-=2*w[M-d-1];for(y=Array(U-d),b=d+1;b<=U;b++)y[b-d-1]=s[b];for(j=numeric.tensor(i,numeric.dot(i,y)),b=d+1;b<=U;b++)for(m=s[b],w=j[b-d-1],M=0;M<r;M++)m[M]-=2*w[M]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(n,e){var r=numeric.toUpperHessenberg(n),o=numeric.QRFrancis(r.H,e),i=numeric.T,P=n.length,t,u,c=o.B,f=numeric.dot(o.Q,numeric.dot(r.H,numeric.transpose(o.Q))),l=new i(numeric.dot(o.Q,r.Q)),a,v=c.length,s,m,h,y,j,w,b,d,M,x,S,p,_,F,V=Math.sqrt;for(u=0;u<v;u++)if(t=c[u][0],t!==c[u][1]){if(s=t+1,m=f[t][t],h=f[t][s],y=f[s][t],j=f[s][s],h===0&&y===0)continue;w=-m-j,b=m*j-h*y,d=w*w-4*b,d>=0?(w<0?M=-.5*(w-V(d)):M=-.5*(w+V(d)),_=(m-M)*(m-M)+h*h,F=y*y+(j-M)*(j-M),_>F?(_=V(_),S=(m-M)/_,p=h/_):(F=V(F),S=y/F,p=(j-M)/F),a=new i([[p,-S],[S,p]]),l.setRows(t,s,a.dot(l.getRows(t,s)))):(M=-.5*w,x=.5*V(-d),_=(m-M)*(m-M)+h*h,F=y*y+(j-M)*(j-M),_>F?(_=V(_+x*x),S=(m-M)/_,p=h/_,M=0,x/=_):(F=V(F+x*x),S=y/F,p=(j-M)/F,M=x/F,x=0),a=new i([[p,-S],[S,p]],[[M,x],[x,-M]]),l.setRows(t,s,a.dot(l.getRows(t,s))))}var U=l.dot(n).dot(l.transjugate()),P=n.length,L=numeric.T.identity(P);for(s=0;s<P;s++)if(s>0)for(u=s-1;u>=0;u--){var D=U.get([u,u]),R=U.get([s,s]);if(numeric.neq(D.x,R.x)||numeric.neq(D.y,R.y))M=U.getRow(u).getBlock([u],[s-1]),x=L.getRow(s).getBlock([u],[s-1]),L.set([s,u],U.get([u,s]).neg().sub(M.dot(x)).div(D.sub(R)));else{L.setRow(s,L.getRow(u));continue}}for(s=0;s<P;s++)M=L.getRow(s),L.setRow(s,M.div(M.norm2()));return L=L.transpose(),L=l.transjugate().dot(L),{lambda:U.getDiag(),E:L}},numeric.ccsSparse=function(n){var e=n.length,u,r,o,i,t=[];for(o=e-1;o!==-1;--o){r=n[o];for(i in r){for(i=parseInt(i);i>=t.length;)t[t.length]=0;r[i]!==0&&t[i]++}}var u=t.length,c=Array(u+1);for(c[0]=0,o=0;o<u;++o)c[o+1]=c[o]+t[o];var f=Array(c[u]),l=Array(c[u]);for(o=e-1;o!==-1;--o){r=n[o];for(i in r)r[i]!==0&&(t[i]--,f[c[i]+t[i]]=o,l[c[i]+t[i]]=r[i])}return[c,f,l]},numeric.ccsFull=function(n){var e=n[0],r=n[1],o=n[2],i=numeric.ccsDim(n),t=i[0],u=i[1],c,f,l,a,v=numeric.rep([t,u],0);for(c=0;c<u;c++)for(l=e[c],a=e[c+1],f=l;f<a;++f)v[r[f]][c]=o[f];return v},numeric.ccsTSolve=function(n,e,r,o,i){var t=n[0],u=n[1],c=n[2],f=t.length-1,l=Math.max,a=0;typeof o>"u"&&(r=numeric.rep([f],0)),typeof o>"u"&&(o=numeric.linspace(0,r.length-1)),typeof i>"u"&&(i=[]);function v(d){var M;if(r[d]===0){for(r[d]=1,M=t[d];M<t[d+1];++M)v(u[M]);i[a]=d,++a}}var s,m,h,y,j,w,b;for(s=o.length-1;s!==-1;--s)v(o[s]);for(i.length=a,s=i.length-1;s!==-1;--s)r[i[s]]=0;for(s=o.length-1;s!==-1;--s)m=o[s],r[m]=e[m];for(s=i.length-1;s!==-1;--s){for(m=i[s],h=t[m],y=l(t[m+1],h),j=h;j!==y;++j)if(u[j]===m){r[m]/=c[j];break}for(b=r[m],j=h;j!==y;++j)w=u[j],w!==m&&(r[w]-=b*c[j])}return r},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(n,e,r,o,i,t){var u=0,c,f=i.length,l=this.k,a=this.k1,v=this.j,s,m;if(o[n]===0)for(o[n]=1,v[0]=n,l[0]=s=e[n],a[0]=m=e[n+1];;)if(s>=m){if(i[f]=v[u],u===0)return;++f,--u,s=l[u],m=a[u]}else c=t[r[s]],o[c]===0?(o[c]=1,l[u]=s,++u,v[u]=c,s=e[c],a[u]=m=e[c+1]):++s},numeric.ccsLPSolve=function(n,e,r,o,i,t,u){var c=n[0],f=n[1],l=n[2];c.length-1;var a=e[0],v=e[1],s=e[2],m,h,y,j,w,b,d,M,x;for(h=a[i],y=a[i+1],o.length=0,m=h;m<y;++m)u.dfs(t[v[m]],c,f,r,o,t);for(m=o.length-1;m!==-1;--m)r[o[m]]=0;for(m=h;m!==y;++m)j=t[v[m]],r[j]=s[m];for(m=o.length-1;m!==-1;--m){for(j=o[m],w=c[j],b=c[j+1],d=w;d<b;++d)if(t[f[d]]===j){r[j]/=l[d];break}for(x=r[j],d=w;d<b;++d)M=t[f[d]],M!==j&&(r[M]-=x*l[d])}return r},numeric.ccsLUP1=function(n,e){var r=n[0].length-1,o=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],t=o[0],u=o[1],c=o[2],f=i[0],l=i[1],a=i[2],v=numeric.rep([r],0),s=numeric.rep([r],0),m,h,y,j,w,b,d,M=numeric.ccsLPSolve,x=Math.abs,S=numeric.linspace(0,r-1),p=numeric.linspace(0,r-1),_=new numeric.ccsDFS(r);for(typeof e>"u"&&(e=1),m=0;m<r;++m){for(M(o,n,v,s,m,p,_),j=-1,w=-1,h=s.length-1;h!==-1;--h)y=s[h],!(y<=m)&&(b=x(v[y]),b>j&&(w=y,j=b));for(x(v[m])<e*j&&(h=S[m],j=S[w],S[m]=j,p[j]=m,S[w]=h,p[h]=w,j=v[m],v[m]=v[w],v[w]=j),j=t[m],w=f[m],d=v[m],u[j]=S[m],c[j]=1,++j,h=s.length-1;h!==-1;--h)y=s[h],b=v[y],s[h]=0,v[y]=0,y<=m?(l[w]=y,a[w]=b,++w):(u[j]=S[y],c[j]=b/d,++j);t[m+1]=j,f[m+1]=w}for(h=u.length-1;h!==-1;--h)u[h]=p[u[h]];return{L:o,U:i,P:S,Pinv:p}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(n,e,r,o,i,t,u){var c=0,f,l=i.length,a=this.k,v=this.k1,s=this.j,m,h;if(o[n]===0)for(o[n]=1,s[0]=n,a[0]=m=e[t[n]],v[0]=h=e[t[n]+1];;){if(isNaN(m))throw new Error("Ow!");if(m>=h){if(i[l]=t[s[c]],c===0)return;++l,--c,m=a[c],h=v[c]}else f=r[m],o[f]===0?(o[f]=1,a[c]=m,++c,s[c]=f,f=t[f],m=e[f],v[c]=h=e[f+1]):++m}},numeric.ccsLPSolve0=function(n,e,r,o,i,t,u,c){var f=n[0],l=n[1],a=n[2];f.length-1;var v=e[0],s=e[1],m=e[2],h,y,j,w,b,d,M,x,S;for(y=v[i],j=v[i+1],o.length=0,h=y;h<j;++h)c.dfs(s[h],f,l,r,o,t,u);for(h=o.length-1;h!==-1;--h)w=o[h],r[u[w]]=0;for(h=y;h!==j;++h)w=s[h],r[w]=m[h];for(h=o.length-1;h!==-1;--h){for(w=o[h],x=u[w],b=f[w],d=f[w+1],M=b;M<d;++M)if(l[M]===x){r[x]/=a[M];break}for(S=r[x],M=b;M<d;++M)r[l[M]]-=S*a[M];r[x]=S}},numeric.ccsLUP0=function(n,e){var r=n[0].length-1,o=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],t=o[0],u=o[1],c=o[2],f=i[0],l=i[1],a=i[2],v=numeric.rep([r],0),s=numeric.rep([r],0),m,h,y,j,w,b,d,M=numeric.ccsLPSolve0,x=Math.abs,S=numeric.linspace(0,r-1),p=numeric.linspace(0,r-1),_=new numeric.ccsDFS0(r);for(typeof e>"u"&&(e=1),m=0;m<r;++m){for(M(o,n,v,s,m,p,S,_),j=-1,w=-1,h=s.length-1;h!==-1;--h)y=s[h],!(y<=m)&&(b=x(v[S[y]]),b>j&&(w=y,j=b));for(x(v[S[m]])<e*j&&(h=S[m],j=S[w],S[m]=j,p[j]=m,S[w]=h,p[h]=w),j=t[m],w=f[m],d=v[S[m]],u[j]=S[m],c[j]=1,++j,h=s.length-1;h!==-1;--h)y=s[h],b=v[S[y]],s[h]=0,v[S[y]]=0,y<=m?(l[w]=y,a[w]=b,++w):(u[j]=S[y],c[j]=b/d,++j);t[m+1]=j,f[m+1]=w}for(h=u.length-1;h!==-1;--h)u[h]=p[u[h]];return{L:o,U:i,P:S,Pinv:p}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(n){return[numeric.sup(n[1])+1,n[0].length-1]},numeric.ccsGetBlock=function(n,e,r){var o=numeric.ccsDim(n),i=o[0],t=o[1];typeof e>"u"?e=numeric.linspace(0,i-1):typeof e=="number"&&(e=[e]),typeof r>"u"?r=numeric.linspace(0,t-1):typeof r=="number"&&(r=[r]);var u,c=e.length,f,l=r.length,a,v,s,m=numeric.rep([t],0),h=[],y=[],j=[m,h,y],w=n[0],b=n[1],d=n[2],M=numeric.rep([i],0),x=0,S=numeric.rep([i],0);for(f=0;f<l;++f){v=r[f];var p=w[v],_=w[v+1];for(u=p;u<_;++u)a=b[u],S[a]=1,M[a]=d[u];for(u=0;u<c;++u)s=e[u],S[s]&&(h[x]=u,y[x]=M[e[u]],++x);for(u=p;u<_;++u)a=b[u],S[a]=0;m[f+1]=x}return j},numeric.ccsDot=function(n,e){var r=n[0],o=n[1],i=n[2],t=e[0],u=e[1],c=e[2],f=numeric.ccsDim(n),l=numeric.ccsDim(e),a=f[0];f[1];var v=l[1],s=numeric.rep([a],0),m=numeric.rep([a],0),h=Array(a),y=numeric.rep([v],0),j=[],w=[],b=[y,j,w],d,M,x,S,p,_,F,V,U,P,L;for(x=0;x!==v;++x){for(S=t[x],p=t[x+1],U=0,M=S;M<p;++M)for(P=u[M],L=c[M],_=r[P],F=r[P+1],d=_;d<F;++d)V=o[d],m[V]===0&&(h[U]=V,m[V]=1,U=U+1),s[V]=s[V]+i[d]*L;for(S=y[x],p=S+U,y[x+1]=p,M=U-1;M!==-1;--M)L=S+M,d=h[M],j[L]=d,w[L]=s[d],m[d]=0,s[d]=0;y[x+1]=y[x]+U}return b},numeric.ccsLUPSolve=function(n,e){var r=n.L,o=n.U;n.P;var i=e[0],t=!1;typeof i!="object"&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],i=e[0],t=!0);var u=e[1],c=e[2],f=r[0].length-1,l=i.length-1,a=numeric.rep([f],0),v=Array(f),s=numeric.rep([f],0),m=Array(f),h=numeric.rep([l+1],0),y=[],j=[],w=numeric.ccsTSolve,b,d,M,x,S,p,_=0;for(b=0;b<l;++b){for(S=0,M=i[b],x=i[b+1],d=M;d<x;++d)p=n.Pinv[u[d]],m[S]=p,s[p]=c[d],++S;for(m.length=S,w(r,s,a,m,v),d=m.length-1;d!==-1;--d)s[m[d]]=0;if(w(o,a,s,v,m),t)return s;for(d=v.length-1;d!==-1;--d)a[v[d]]=0;for(d=m.length-1;d!==-1;--d)p=m[d],y[_]=p,j[_]=s[p],s[p]=0,++_;h[b+1]=_}return[h,y,j]},numeric.ccsbinop=function(n,e){return typeof e>"u"&&(e=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+e+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+n+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},(function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)})(),numeric.ccsScatter=function g(n){var e=n[0],r=n[1],o=n[2],i=numeric.sup(r)+1,t=e.length,u=numeric.rep([i],0),c=Array(t),f=Array(t),l=numeric.rep([i],0),a;for(a=0;a<t;++a)l[r[a]]++;for(a=0;a<i;++a)u[a+1]=u[a]+l[a];var v=u.slice(0),s,m;for(a=0;a<t;++a)m=r[a],s=v[m],c[s]=e[a],f[s]=o[a],v[m]=v[m]+1;return[u,c,f]},numeric.ccsGather=function g(n){var e=n[0],r=n[1],o=n[2],i=e.length-1,t=r.length,u=Array(t),c=Array(t),f=Array(t),l,a,v,s,m;for(m=0,l=0;l<i;++l)for(v=e[l],s=e[l+1],a=v;a!==s;++a)c[m]=l,u[m]=r[a],f[m]=o[a],++m;return[u,c,f]},numeric.sdim=function g(n,e,r){if(typeof e>"u"&&(e=[]),typeof n!="object")return e;typeof r>"u"&&(r=0),r in e||(e[r]=0),n.length>e[r]&&(e[r]=n.length);var o;for(o in n)n.hasOwnProperty(o)&&g(n[o],e,r+1);return e},numeric.sclone=function g(n,e,r){typeof e>"u"&&(e=0),typeof r>"u"&&(r=numeric.sdim(n).length);var o,i=Array(n.length);if(e===r-1){for(o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);return i}for(o in n)n.hasOwnProperty(o)&&(i[o]=g(n[o],e+1,r));return i},numeric.sdiag=function g(n){var e=n.length,r,o=Array(e),i;for(r=e-1;r>=1;r-=2)i=r-1,o[r]=[],o[r][r]=n[r],o[i]=[],o[i][i]=n[i];return r===0&&(o[0]=[],o[0][0]=n[r]),o},numeric.sidentity=function g(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function g(n){var e=[];n.length;var r,o,i;for(r in n)if(n.hasOwnProperty(r)){i=n[r];for(o in i)i.hasOwnProperty(o)&&(typeof e[o]!="object"&&(e[o]=[]),e[o][r]=i[o])}return e},numeric.sLUP=function g(n,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function g(n,e){var r=n.length;e.length;var o=numeric.stranspose(e),i=o.length,t,u,c,f,l,a,v=Array(r),s;for(c=r-1;c>=0;c--){for(s=[],t=n[c],l=i-1;l>=0;l--){a=0,u=o[l];for(f in t)t.hasOwnProperty(f)&&f in u&&(a+=t[f]*u[f]);a&&(s[l]=a)}v[c]=s}return v},numeric.sdotMV=function g(n,e){var r=n.length,o,i,t,u=Array(r),c;for(i=r-1;i>=0;i--){o=n[i],c=0;for(t in o)o.hasOwnProperty(t)&&e[t]&&(c+=o[t]*e[t]);c&&(u[i]=c)}return u},numeric.sdotVM=function g(n,e){var r,o,i,t,u=[];for(r in n)if(n.hasOwnProperty(r)){i=e[r],t=n[r];for(o in i)i.hasOwnProperty(o)&&(u[o]||(u[o]=0),u[o]+=t*i[o])}return u},numeric.sdotVV=function g(n,e){var r,o=0;for(r in n)n[r]&&e[r]&&(o+=n[r]*e[r]);return o},numeric.sdot=function g(n,e){var r=numeric.sdim(n).length,o=numeric.sdim(e).length,i=r*1e3+o;switch(i){case 0:return n*e;case 1001:return numeric.sdotVV(n,e);case 2001:return numeric.sdotMV(n,e);case 1002:return numeric.sdotVM(n,e);case 2002:return numeric.sdotMM(n,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+o)}},numeric.sscatter=function g(n){var e=n[0].length,r,o,i,t=n.length,u=[],c;for(o=e-1;o>=0;--o)if(n[t-1][o]){for(c=u,i=0;i<t-2;i++)r=n[i][o],c[r]||(c[r]=[]),c=c[r];c[n[i][o]]=n[i+1][o]}return u},numeric.sgather=function g(n,e,r){typeof e>"u"&&(e=[]),typeof r>"u"&&(r=[]);var o,i,t;o=r.length;for(i in n)if(n.hasOwnProperty(i))if(r[o]=parseInt(i),t=n[i],typeof t=="number"){if(t){if(e.length===0)for(i=o+1;i>=0;--i)e[i]=[];for(i=o;i>=0;--i)e[i].push(r[i]);e[o+1].push(t)}}else g(t,e,r);return r.length>o&&r.pop(),e},numeric.cLU=function g(n){var e=n[0],r=n[1],o=n[2],_=e.length,i=0,t,u,c,f,l,a;for(t=0;t<_;t++)e[t]>i&&(i=e[t]);i++;var v=Array(i),s=Array(i),m=numeric.rep([i],1/0),h=numeric.rep([i],-1/0),b,d,y;for(c=0;c<_;c++)t=e[c],u=r[c],u<m[t]&&(m[t]=u),u>h[t]&&(h[t]=u);for(t=0;t<i-1;t++)h[t]>h[t+1]&&(h[t+1]=h[t]);for(t=i-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);var j=0,w=0;for(t=0;t<i;t++)s[t]=numeric.rep([h[t]-m[t]+1],0),v[t]=numeric.rep([t-m[t]],0),j+=t-m[t]+1,w+=h[t]-t+1;for(c=0;c<_;c++)t=e[c],s[t][r[c]-m[t]]=o[c];for(t=0;t<i-1;t++)for(f=t-m[t],b=s[t],u=t+1;m[u]<=t&&u<i;u++)if(l=t-m[u],a=h[t]-t,d=s[u],y=d[l]/b[f],y){for(c=1;c<=a;c++)d[c+l]-=y*b[c+f];v[u][t-m[u]]=y}var b=[],d=[],M=[],x=[],S=[],p=[],_,F,V;for(_=0,F=0,t=0;t<i;t++){for(f=m[t],l=h[t],V=s[t],u=t;u<=l;u++)V[u-f]&&(b[_]=t,d[_]=u,M[_]=V[u-f],_++);for(V=v[t],u=f;u<t;u++)V[u-f]&&(x[F]=t,S[F]=u,p[F]=V[u-f],F++);x[F]=t,S[F]=t,p[F]=1,F++}return{U:[b,d,M],L:[x,S,p]}},numeric.cLUsolve=function g(n,e){var r=n.L,o=n.U,i=numeric.clone(e),t=r[0],u=r[1],c=r[2],f=o[0],l=o[1],a=o[2],v=f.length;t.length;var s=i.length,m,h;for(h=0,m=0;m<s;m++){for(;u[h]<m;)i[m]-=c[h]*i[u[h]],h++;h++}for(h=v-1,m=s-1;m>=0;m--){for(;l[h]>m;)i[m]-=a[h]*i[l[h]],h--;i[m]/=a[h],h--}return i},numeric.cgrid=function g(n,e){typeof n=="number"&&(n=[n,n]);var r=numeric.rep(n,-1),o,i,t;if(typeof e!="function")switch(e){case"L":e=function(u,c){return u>=n[0]/2||c<n[1]/2};break;default:e=function(u,c){return!0};break}for(t=0,o=1;o<n[0]-1;o++)for(i=1;i<n[1]-1;i++)e(o,i)&&(r[o][i]=t,t++);return r},numeric.cdelsq=function g(n){var e=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(n),o=r[0],i=r[1],t,u,c,f,l,a=[],v=[],s=[];for(t=1;t<o-1;t++)for(u=1;u<i-1;u++)if(!(n[t][u]<0)){for(c=0;c<4;c++)f=t+e[c][0],l=u+e[c][1],!(n[f][l]<0)&&(a.push(n[t][u]),v.push(n[f][l]),s.push(-1));a.push(n[t][u]),v.push(n[t][u]),s.push(4)}return[a,v,s]},numeric.cdotMV=function g(n,e){var r,o=n[0],i=n[1],t=n[2],u,c=o.length,f;for(f=0,u=0;u<c;u++)o[u]>f&&(f=o[u]);for(f++,r=numeric.rep([f],0),u=0;u<c;u++)r[o[u]]+=t[u]*e[i[u]];return r},numeric.Spline=function g(n,e,r,o,i){this.x=n,this.yl=e,this.yr=r,this.kl=o,this.kr=i},numeric.Spline.prototype._at=function g(c,e){var r=this.x,o=this.yl,i=this.yr,t=this.kl,u=this.kr,c,f,l,a,v=numeric.add,s=numeric.sub,m=numeric.mul;f=s(m(t[e],r[e+1]-r[e]),s(i[e+1],o[e])),l=v(m(u[e+1],r[e]-r[e+1]),s(i[e+1],o[e])),a=(c-r[e])/(r[e+1]-r[e]);var h=a*(1-a);return v(v(v(m(1-a,o[e]),m(a,i[e+1])),m(f,h*(1-a))),m(l,h*a))},numeric.Spline.prototype.at=function g(n){if(typeof n=="number"){var e=this.x,u=e.length,r,o,i,t=Math.floor;for(r=0,o=u-1;o-r>1;)i=t((r+o)/2),e[i]<=n?r=i:o=i;return this._at(n,r)}var u=n.length,c,f=Array(u);for(c=u-1;c!==-1;--c)f[c]=this.at(n[c]);return f},numeric.Spline.prototype.diff=function g(){var n=this.x,e=this.yl,r=this.yr,o=this.kl,i=this.kr,t=e.length,u,c,f,l=o,a=i,v=Array(t),s=Array(t),m=numeric.add,h=numeric.mul,y=numeric.div,j=numeric.sub;for(u=t-1;u!==-1;--u)c=n[u+1]-n[u],f=j(r[u+1],e[u]),v[u]=y(m(h(f,6),h(o[u],-4*c),h(i[u+1],-2*c)),c*c),s[u+1]=y(m(h(f,-6),h(o[u],2*c),h(i[u+1],4*c)),c*c);return new numeric.Spline(n,l,a,v,s)},numeric.Spline.prototype.roots=function g(){function n(E){return E*E}var y=[],e=this.x,r=this.yl,o=this.yr,i=this.kl,t=this.kr;typeof r[0]=="number"&&(r=[r],o=[o],i=[i],t=[t]);var u=r.length,c=e.length-1,f,l,a,v,s,m,h,y=Array(u),j,w,b,d,M,x,S,p,_,F,V,U,P,L,D,R,q=Math.sqrt;for(f=0;f!==u;++f){for(v=r[f],s=o[f],m=i[f],h=t[f],j=[],l=0;l!==c;l++){for(l>0&&s[l]*v[l]<0&&j.push(e[l]),_=e[l+1]-e[l],e[l],d=v[l],M=s[l+1],w=m[l]/_,b=h[l+1]/_,p=n(w-b+3*(d-M))+12*b*d,x=b+3*d+2*w-3*M,S=3*(b+w+2*(d-M)),p<=0?(V=x/S,V>e[l]&&V<e[l+1]?F=[e[l],V,e[l+1]]:F=[e[l],e[l+1]]):(V=(x-q(p))/S,U=(x+q(p))/S,F=[e[l]],V>e[l]&&V<e[l+1]&&F.push(V),U>e[l]&&U<e[l+1]&&F.push(U),F.push(e[l+1])),L=F[0],V=this._at(L,l),a=0;a<F.length-1;a++){if(D=F[a+1],U=this._at(D,l),V===0){j.push(L),L=D,V=U;continue}if(U===0||V*U>0){L=D,V=U;continue}for(var N=0;R=(V*D-U*L)/(V-U),!(R<=L||R>=D);)if(P=this._at(R,l),P*U>0)D=R,U=P,N===-1&&(V*=.5),N=-1;else if(P*V>0)L=R,V=P,N===1&&(U*=.5),N=1;else break;j.push(R),L=F[a+1],V=this._at(L,l)}U===0&&j.push(D)}y[f]=j}return typeof this.yl[0]=="number"?y[0]:y},numeric.spline=function g(n,e,r,o){var i=n.length,t=[],u=[],c=[],f,l=numeric.sub,a=numeric.mul,v=numeric.add;for(f=i-2;f>=0;f--)u[f]=n[f+1]-n[f],c[f]=l(e[f+1],e[f]);(typeof r=="string"||typeof o=="string")&&(r=o="periodic");var s=[[],[],[]];switch(typeof r){case"undefined":t[0]=a(3/(u[0]*u[0]),c[0]),s[0].push(0,0),s[1].push(0,1),s[2].push(2/u[0],1/u[0]);break;case"string":t[0]=v(a(3/(u[i-2]*u[i-2]),c[i-2]),a(3/(u[0]*u[0]),c[0])),s[0].push(0,0,0),s[1].push(i-2,0,1),s[2].push(1/u[i-2],2/u[i-2]+2/u[0],1/u[0]);break;default:t[0]=r,s[0].push(0),s[1].push(0),s[2].push(1);break}for(f=1;f<i-1;f++)t[f]=v(a(3/(u[f-1]*u[f-1]),c[f-1]),a(3/(u[f]*u[f]),c[f])),s[0].push(f,f,f),s[1].push(f-1,f,f+1),s[2].push(1/u[f-1],2/u[f-1]+2/u[f],1/u[f]);switch(typeof o){case"undefined":t[i-1]=a(3/(u[i-2]*u[i-2]),c[i-2]),s[0].push(i-1,i-1),s[1].push(i-2,i-1),s[2].push(1/u[i-2],2/u[i-2]);break;case"string":s[1][s[1].length-1]=0;break;default:t[i-1]=o,s[0].push(i-1),s[1].push(i-1),s[2].push(1);break}typeof t[0]!="number"?t=numeric.transpose(t):t=[t];var m=Array(t.length);if(typeof r=="string")for(f=m.length-1;f!==-1;--f)m[f]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(s)),t[f]),m[f][i-1]=m[f][0];else for(f=m.length-1;f!==-1;--f)m[f]=numeric.cLUsolve(numeric.cLU(s),t[f]);return typeof e[0]=="number"?m=m[0]:m=numeric.transpose(m),new numeric.Spline(n,e,e,m,m)},numeric.fftpow2=function g(n,e){var r=n.length;if(r!==1){var o=Math.cos,i=Math.sin,t,u,c=Array(r/2),f=Array(r/2),l=Array(r/2),a=Array(r/2);for(u=r/2,t=r-1;t!==-1;--t)--u,l[u]=n[t],a[u]=e[t],--t,c[u]=n[t],f[u]=e[t];g(c,f),g(l,a),u=r/2;var v,s=-6.283185307179586/r,m,h;for(t=r-1;t!==-1;--t)--u,u===-1&&(u=r/2-1),v=s*t,m=o(v),h=i(v),n[t]=c[u]+m*l[u]-h*a[u],e[t]=f[u]+m*a[u]+h*l[u]}},numeric._ifftpow2=function g(n,e){var r=n.length;if(r!==1){var o=Math.cos,i=Math.sin,t,u,c=Array(r/2),f=Array(r/2),l=Array(r/2),a=Array(r/2);for(u=r/2,t=r-1;t!==-1;--t)--u,l[u]=n[t],a[u]=e[t],--t,c[u]=n[t],f[u]=e[t];g(c,f),g(l,a),u=r/2;var v,s=6.283185307179586/r,m,h;for(t=r-1;t!==-1;--t)--u,u===-1&&(u=r/2-1),v=s*t,m=o(v),h=i(v),n[t]=c[u]+m*l[u]-h*a[u],e[t]=f[u]+m*a[u]+h*l[u]}},numeric.ifftpow2=function g(n,e){numeric._ifftpow2(n,e),numeric.diveq(n,n.length),numeric.diveq(e,e.length)},numeric.convpow2=function g(n,e,r,o){numeric.fftpow2(n,e),numeric.fftpow2(r,o);var i,t=n.length,u,c,f,l;for(i=t-1;i!==-1;--i)u=n[i],f=e[i],c=r[i],l=o[i],n[i]=u*c-f*l,e[i]=u*l+f*c;numeric.ifftpow2(n,e)},numeric.T.prototype.fft=function g(){var n=this.x,e=this.y,r=n.length,o=Math.log,i=o(2),t=Math.ceil(o(2*r-1)/i),u=Math.pow(2,t),c=numeric.rep([u],0),f=numeric.rep([u],0),l=Math.cos,a=Math.sin,v,s=-3.141592653589793/r,m,h=numeric.rep([u],0),y=numeric.rep([u],0);for(v=0;v<r;v++)h[v]=n[v];if(typeof e<"u")for(v=0;v<r;v++)y[v]=e[v];for(c[0]=1,v=1;v<=u/2;v++)m=s*v*v,c[v]=l(m),f[v]=a(m),c[u-v]=l(m),f[u-v]=a(m);var j=new numeric.T(h,y),w=new numeric.T(c,f);return j=j.mul(w),numeric.convpow2(j.x,j.y,numeric.clone(w.x),numeric.neg(w.y)),j=j.mul(w),j.x.length=r,j.y.length=r,j},numeric.T.prototype.ifft=function g(){var n=this.x,e=this.y,r=n.length,o=Math.log,i=o(2),t=Math.ceil(o(2*r-1)/i),u=Math.pow(2,t),c=numeric.rep([u],0),f=numeric.rep([u],0),l=Math.cos,a=Math.sin,v,s=3.141592653589793/r,m,h=numeric.rep([u],0),y=numeric.rep([u],0);for(v=0;v<r;v++)h[v]=n[v];if(typeof e<"u")for(v=0;v<r;v++)y[v]=e[v];for(c[0]=1,v=1;v<=u/2;v++)m=s*v*v,c[v]=l(m),f[v]=a(m),c[u-v]=l(m),f[u-v]=a(m);var j=new numeric.T(h,y),w=new numeric.T(c,f);return j=j.mul(w),numeric.convpow2(j.x,j.y,numeric.clone(w.x),numeric.neg(w.y)),j=j.mul(w),j.x.length=r,j.y.length=r,j.div(r)},numeric.gradient=function g(n,e){var r=e.length,o=n(e);if(isNaN(o))throw new Error("gradient: f(x) is a NaN!");var a=Math.max,i,t=numeric.clone(e),u,c,f=Array(r);numeric.div,numeric.sub;var l,a=Math.max,v=.001,s=Math.abs,m=Math.min,h,y,j,w=0,b,d,M;for(i=0;i<r;i++)for(var x=a(1e-6*o,1e-8);;){if(++w,w>20)throw new Error("Numerical gradient fails");if(t[i]=e[i]+x,u=n(t),t[i]=e[i]-x,c=n(t),t[i]=e[i],isNaN(u)||isNaN(c)){x/=16;continue}if(f[i]=(u-c)/(2*x),h=e[i]-x,y=e[i],j=e[i]+x,b=(u-o)/x,d=(o-c)/x,M=a(s(f[i]),s(o),s(u),s(c),s(h),s(y),s(j),1e-8),l=m(a(s(b-f[i]),s(d-f[i]),s(b-d))/M,x/M),l>v)x/=16;else break}return f},numeric.uncmin=function g(n,e,r,o,i,t,u){var c=numeric.gradient;typeof u>"u"&&(u={}),typeof r>"u"&&(r=1e-8),typeof o>"u"&&(o=function(rr){return c(n,rr)}),typeof i>"u"&&(i=1e3),e=numeric.clone(e);var f=e.length,l=n(e),a,v;if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var s=Math.max,m=numeric.norm2;r=s(r,numeric.epsilon);var h,y,j,w=u.Hinv||numeric.identity(f),b=numeric.dot;numeric.inv;var d=numeric.sub,M=numeric.add,x=numeric.tensor,S=numeric.div,p=numeric.mul,_=numeric.all,F=numeric.isFinite,V=numeric.neg,U=0,P,L,D,R,q,N,E,$="";for(y=o(e);U<i;){if(typeof t=="function"&&t(U,e,l,y,w)){$="Callback returned true";break}if(!_(F(y))){$="Gradient has Infinity or NaN";break}if(h=V(b(w,y)),!_(F(h))){$="Search direction has Infinity or NaN";break}if(E=m(h),E<r){$="Newton step smaller than tol";break}for(N=1,v=b(y,h),L=e;U<i&&!(N*E<r);){if(P=p(h,N),L=M(e,P),a=n(L),a-l>=.1*N*v||isNaN(a)){N*=.5,++U;continue}break}if(N*E<r){$="Line search step size smaller than tol";break}if(U===i){$="maxit reached during line search";break}j=o(L),D=d(j,y),q=b(D,P),R=b(w,D),w=d(M(w,p((q+b(D,R))/(q*q),x(P,P))),S(M(x(R,P),x(P,R)),q)),e=L,l=a,y=j,++U}return{solution:e,f:l,gradient:y,invHessian:w,iterations:U,message:$}},numeric.Dopri=function g(n,e,r,o,i,t,u){this.x=n,this.y=e,this.f=r,this.ymid=o,this.iterations=i,this.events=u,this.message=t},numeric.Dopri.prototype._at=function g(h,e){function r(p){return p*p}var o=this,i=o.x,t=o.y,u=o.f,c=o.ymid;i.length;var f,l,a,v,s,m,h,y,j=.5,w=numeric.add,b=numeric.mul,d=numeric.sub,M,x,S;return f=i[e],l=i[e+1],v=t[e],s=t[e+1],y=l-f,a=f+j*y,m=c[e],M=d(u[e],b(v,1/(f-a)+2/(f-l))),x=d(u[e+1],b(s,1/(l-a)+2/(l-f))),S=[r(h-l)*(h-a)/r(f-l)/(f-a),r(h-f)*r(h-l)/r(f-a)/r(l-a),r(h-f)*(h-a)/r(l-f)/(l-a),(h-f)*r(h-l)*(h-a)/r(f-l)/(f-a),(h-l)*r(h-f)*(h-a)/r(f-l)/(l-a)],w(w(w(w(b(v,S[0]),b(m,S[1])),b(s,S[2])),b(M,S[3])),b(x,S[4]))},numeric.Dopri.prototype.at=function g(n){var e,r,o,i=Math.floor;if(typeof n!="number"){var t=n.length,u=Array(t);for(e=t-1;e!==-1;--e)u[e]=this.at(n[e]);return u}var c=this.x;for(e=0,r=c.length-1;r-e>1;)o=i(.5*(e+r)),c[o]<=n?e=o:r=o;return this._at(n,e)},numeric.dopri=function g(n,e,r,o,i,t,u){typeof i>"u"&&(i=1e-6),typeof t>"u"&&(t=1e3);var c=[n],f=[r],l=[o(n,r)],a,v,s,m,h,y,j=[],w=1/5,b=[3/40,9/40],d=[44/45,-56/15,32/9],M=[19372/6561,-25360/2187,64448/6561,-212/729],x=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],p=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],_=[1/5,3/10,4/5,8/9,1,1],F=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],V=0,U,P,L=(e-n)/10,D=0,R=numeric.add,q=numeric.mul,N,E,$=Math.min,rr=Math.abs,O=numeric.norminf,I=Math.pow,W=numeric.any,G=numeric.lt,Q=numeric.and;numeric.sub;var X,Z,J,z=new numeric.Dopri(c,f,l,j,-1,"");for(typeof u=="function"&&(X=u(n,r));n<e&&D<t;){if(++D,n+L>e&&(L=e-n),a=o(n+_[0]*L,R(r,q(w*L,l[V]))),v=o(n+_[1]*L,R(R(r,q(b[0]*L,l[V])),q(b[1]*L,a))),s=o(n+_[2]*L,R(R(R(r,q(d[0]*L,l[V])),q(d[1]*L,a)),q(d[2]*L,v))),m=o(n+_[3]*L,R(R(R(R(r,q(M[0]*L,l[V])),q(M[1]*L,a)),q(M[2]*L,v)),q(M[3]*L,s))),h=o(n+_[4]*L,R(R(R(R(R(r,q(x[0]*L,l[V])),q(x[1]*L,a)),q(x[2]*L,v)),q(x[3]*L,s)),q(x[4]*L,m))),N=R(R(R(R(R(r,q(l[V],L*S[0])),q(v,L*S[2])),q(s,L*S[3])),q(m,L*S[4])),q(h,L*S[5])),y=o(n+L,N),U=R(R(R(R(R(q(l[V],L*F[0]),q(v,L*F[2])),q(s,L*F[3])),q(m,L*F[4])),q(h,L*F[5])),q(y,L*F[6])),typeof U=="number"?E=rr(U):E=O(U),E>i){if(L=.2*L*I(i/E,.25),n+L===n){z.msg="Step size became too small";break}continue}if(j[V]=R(R(R(R(R(R(r,q(l[V],L*p[0])),q(v,L*p[2])),q(s,L*p[3])),q(m,L*p[4])),q(h,L*p[5])),q(y,L*p[6])),++V,c[V]=n+L,f[V]=N,l[V]=y,typeof u=="function"){var K,ir=n,H=n+.5*L,Y;if(Z=u(H,j[V-1]),J=Q(G(X,0),G(0,Z)),W(J)||(ir=H,H=n+L,X=Z,Z=u(H,N),J=Q(G(X,0),G(0,Z))),W(J)){for(var or,tr,ur=0,er=1,nr=1;;){if(typeof X=="number")Y=(nr*Z*ir-er*X*H)/(nr*Z-er*X);else for(Y=H,P=X.length-1;P!==-1;--P)X[P]<0&&Z[P]>0&&(Y=$(Y,(nr*Z[P]*ir-er*X[P]*H)/(nr*Z[P]-er*X[P])));if(Y<=ir||Y>=H)break;K=z._at(Y,V-1),tr=u(Y,K),or=Q(G(X,0),G(0,tr)),W(or)?(H=Y,Z=tr,J=or,nr=1,ur===-1?er*=.5:er=1,ur=-1):(ir=Y,X=tr,er=1,ur===1?nr*=.5:nr=1,ur=1)}return N=z._at(.5*(n+Y),V-1),z.f[V]=o(Y,K),z.x[V]=Y,z.y[V]=K,z.ymid[V-1]=N,z.events=J,z.iterations=D,z}}n+=L,r=N,X=Z,L=$(.8*L*I(i/E,.25),4*L)}return z.iterations=D,z},numeric.LU=function(g,n){n=n||!1;var e=Math.abs,r,o,i,t,u,c,f,l,a,v=g.length,s=v-1,m=new Array(v);for(n||(g=numeric.clone(g)),i=0;i<v;++i){for(f=i,c=g[i],a=e(c[i]),o=i+1;o<v;++o)t=e(g[o][i]),a<t&&(a=t,f=o);for(m[i]=f,f!=i&&(g[i]=g[f],g[f]=c,c=g[i]),u=c[i],r=i+1;r<v;++r)g[r][i]/=u;for(r=i+1;r<v;++r){for(l=g[r],o=i+1;o<s;++o)l[o]-=l[i]*c[o],++o,l[o]-=l[i]*c[o];o===s&&(l[o]-=l[i]*c[o])}}return{LU:g,P:m}},numeric.LUsolve=function g(n,e){var r,o,i=n.LU,t=i.length,u=numeric.clone(e),c=n.P,f,l,a;for(r=t-1;r!==-1;--r)u[r]=e[r];for(r=0;r<t;++r)for(f=c[r],c[r]!==r&&(a=u[r],u[r]=u[f],u[f]=a),l=i[r],o=0;o<r;++o)u[r]-=u[o]*l[o];for(r=t-1;r>=0;--r){for(l=i[r],o=r+1;o<t;++o)u[r]-=u[o]*l[o];u[r]/=l[r]}return u},numeric.solve=function g(n,e,r){return numeric.LUsolve(numeric.LU(n,r),e)},numeric.echelonize=function g(n){var e=numeric.dim(n),r=e[0],o=e[1],i=numeric.identity(r),t=Array(r),u,c,f,l,a,v,s,m,h=Math.abs,y=numeric.diveq;for(n=numeric.clone(n),u=0;u<r;++u){for(f=0,a=n[u],v=i[u],c=1;c<o;++c)h(a[f])<h(a[c])&&(f=c);for(t[u]=f,y(v,a[f]),y(a,a[f]),c=0;c<r;++c)if(c!==u){for(s=n[c],m=s[f],l=o-1;l!==-1;--l)s[l]-=a[l]*m;for(s=i[c],l=r-1;l!==-1;--l)s[l]-=v[l]*m}}return{I:i,A:n,P:t}},numeric.__solveLP=function g(n,e,r,o,i,t,u){var c=numeric.sum;numeric.log;var f=numeric.mul,l=numeric.sub,a=numeric.dot,v=numeric.div,s=numeric.add,m=n.length,h=r.length,y,j=!1,w=0,b=1;numeric.transpose(e),numeric.svd;var d=numeric.transpose;numeric.leq;var M=Math.sqrt,x=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var S=Math.min,p=numeric.all,_=numeric.gt,F=Array(m),V=Array(h);numeric.rep([h],1);var U,P=numeric.solve,L=l(r,a(e,t)),D,R=a(n,n),q;for(D=w;D<i;++D){var N,E;for(N=h-1;N!==-1;--N)V[N]=v(e[N],L[N]);var $=d(V);for(N=m-1;N!==-1;--N)F[N]=c($[N]);b=.25*x(R/a(n,F));var rr=100*M(R/a(F,F));for((!isFinite(b)||b>rr)&&(b=rr),q=s(n,f(b,F)),U=a($,V),N=m-1;N!==-1;--N)U[N][N]+=1;E=P(U,v(q,b),!0);var O=v(L,a(e,E)),I=1;for(N=h-1;N!==-1;--N)O[N]<0&&(I=S(I,-.999*O[N]));if(y=l(t,f(E,I)),L=l(r,a(e,y)),!p(_(L,0)))return{solution:t,message:"",iterations:D};if(t=y,b<o)return{solution:y,message:"",iterations:D};if(u){var W=a(n,q),G=a(e,q);for(j=!0,N=h-1;N!==-1;--N)if(W*G[N]<0){j=!1;break}}else t[m-1]>=0?j=!1:j=!0;if(j)return{solution:y,message:"Unbounded",iterations:D}}return{solution:t,message:"maximum iteration count exceeded",iterations:D}},numeric._solveLP=function g(n,e,r,o,i){var t=n.length,u=r.length,m;numeric.sum,numeric.log,numeric.mul;var c=numeric.sub,f=numeric.dot;numeric.div,numeric.add;var l=numeric.rep([t],0).concat([1]),a=numeric.rep([u,1],-1),v=numeric.blockMatrix([[e,a]]),s=r,m=numeric.rep([t],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),h=numeric.__solveLP(l,v,s,o,i,m,!1),y=numeric.clone(h.solution);y.length=t;var j=numeric.inf(c(r,f(e,y)));if(j<0)return{solution:NaN,message:"Infeasible",iterations:h.iterations};var w=numeric.__solveLP(n,e,r,o,i-h.iterations,y,!0);return w.iterations+=h.iterations,w},numeric.solveLP=function g(n,e,r,o,i,t,u){if(typeof u>"u"&&(u=1e3),typeof t>"u"&&(t=numeric.epsilon),typeof o>"u")return numeric._solveLP(n,e,r,t,u);var c=o.length,f=o[0].length,l=e.length,a=numeric.echelonize(o),v=numeric.rep([f],0),s=a.P,m=[],h;for(h=s.length-1;h!==-1;--h)v[s[h]]=1;for(h=f-1;h!==-1;--h)v[h]===0&&m.push(h);var y=numeric.getRange,j=numeric.linspace(0,c-1),w=numeric.linspace(0,l-1),b=y(o,j,m),d=y(e,w,s),M=y(e,w,m),x=numeric.dot,S=numeric.sub,p=x(d,a.I),_=S(M,x(p,b)),F=S(r,x(p,i)),V=Array(s.length),U=Array(m.length);for(h=s.length-1;h!==-1;--h)V[h]=n[s[h]];for(h=m.length-1;h!==-1;--h)U[h]=n[m[h]];var P=S(U,x(V,x(a.I,b))),L=numeric._solveLP(P,_,F,t,u),D=L.solution;if(D!==D)return L;var R=x(a.I,S(i,x(b,D))),q=Array(n.length);for(h=s.length-1;h!==-1;--h)q[s[h]]=R[h];for(h=m.length-1;h!==-1;--h)q[m[h]]=D[h];return{solution:q,message:L.message,iterations:L.iterations}},numeric.MPStoLP=function g(n){n instanceof String&&n.split(`
`);var e=0,r=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],o=n.length,i,t,u,c=0,f={},l=[],a=0,v={},s=0,m,h=[],y=[],j=[];function w(S){throw new Error("MPStoLP: "+S+`
Line `+i+": "+n[i]+`
Current state: `+r[e]+`
`)}for(i=0;i<o;++i){u=n[i];var b=u.match(/\S*/g),d=[];for(t=0;t<b.length;++t)b[t]!==""&&d.push(b[t]);if(d.length!==0){for(t=0;t<r.length&&u.substr(0,r[t].length)!==r[t];++t);if(t<r.length){if(e=t,t===1&&(m=d[1]),t===6)return{name:m,c:h,A:numeric.transpose(y),b:j,rows:f,vars:v};continue}switch(e){case 0:case 1:w("Unexpected line");case 2:switch(d[0]){case"N":c===0?c=d[1]:w("Two or more N rows");break;case"L":f[d[1]]=a,l[a]=1,j[a]=0,++a;break;case"G":f[d[1]]=a,l[a]=-1,j[a]=0,++a;break;case"E":f[d[1]]=a,l[a]=0,j[a]=0,++a;break;default:w("Parse error "+numeric.prettyPrint(d))}break;case 3:v.hasOwnProperty(d[0])||(v[d[0]]=s,h[s]=0,y[s]=numeric.rep([a],0),++s);var M=v[d[0]];for(t=1;t<d.length;t+=2){if(d[t]===c){h[M]=parseFloat(d[t+1]);continue}var x=f[d[t]];y[M][x]=(l[x]<0?-1:1)*parseFloat(d[t+1])}break;case 4:for(t=1;t<d.length;t+=2)j[f[d[t]]]=(l[f[d[t]]]<0?-1:1)*parseFloat(d[t+1]);break;case 5:break;case 6:w("Internal error")}}}w("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},(function(g,n,e,r,o,i,t){n.seedrandom=function(v,s){var m=[],h;return v=f(c(s?[v,g]:arguments.length?v:[new Date().getTime(),g,window],3),m),h=new u(m),f(h.S,g),n.random=function(){for(var j=h.g(r),w=t,b=0;j<o;)j=(j+b)*e,w*=e,b=h.g(1);for(;j>=i;)j/=2,w/=2,b>>>=1;return(j+b)/w},v};function u(a){var v,s,m=this,h=a.length,y=0,j=m.i=m.j=m.m=0;for(m.S=[],m.c=[],h||(a=[h++]);y<e;)m.S[y]=y++;for(y=0;y<e;y++)v=m.S[y],j=l(j+v+a[y%h]),s=m.S[j],m.S[y]=s,m.S[j]=v;m.g=function(b){var d=m.S,M=l(m.i+1),x=d[M],S=l(m.j+x),p=d[S];d[M]=p,d[S]=x;for(var _=d[l(x+p)];--b;)M=l(M+1),x=d[M],S=l(S+x),p=d[S],d[M]=p,d[S]=x,_=_*e+d[l(x+p)];return m.i=M,m.j=S,_},m.g(e)}function c(a,v,s,m,h){if(s=[],h=typeof a,v&&h=="object"){for(m in a)if(m.indexOf("S")<5)try{s.push(c(a[m],v-1))}catch{}}return s.length?s:a+(h!="string"?"\0":"")}function f(a,v,s,m){for(a+="",s=0,m=0;m<a.length;m++)v[l(m)]=l((s^=v[l(m)]*19)+a.charCodeAt(m));a="";for(m in v)a+=String.fromCharCode(v[m]);return a}function l(a){return a&e-1}t=n.pow(e,r),o=n.pow(2,o),i=o*2,f(n.random(),g)})([],numeric.seedrandom,256,6,52),(function(g){function n(c){if(typeof c!="object")return c;var f=[],l,a=c.length;for(l=0;l<a;l++)f[l+1]=n(c[l]);return f}function e(c){if(typeof c!="object")return c;var f=[],l,a=c.length;for(l=1;l<a;l++)f[l-1]=e(c[l]);return f}function r(c,f,l){var a,v,s,m,h;for(s=1;s<=l;s=s+1){for(c[s][s]=1/c[s][s],h=-c[s][s],a=1;a<s;a=a+1)c[a][s]=h*c[a][s];if(m=s+1,l<m)break;for(v=m;v<=l;v=v+1)for(h=c[s][v],c[s][v]=0,a=1;a<=s;a=a+1)c[a][v]=c[a][v]+h*c[a][s]}}function o(c,f,l,a){var v,s,m,h;for(s=1;s<=l;s=s+1){for(h=0,v=1;v<s;v=v+1)h=h+c[v][s]*a[v];a[s]=(a[s]-h)/c[s][s]}for(m=1;m<=l;m=m+1)for(s=l+1-m,a[s]=a[s]/c[s][s],h=-a[s],v=1;v<s;v=v+1)a[v]=a[v]+h*c[v][s]}function i(c,f,l,a){var v,s,m,h,y,j;for(s=1;s<=l;s=s+1){if(a[1]=s,j=0,m=s-1,m<1){if(j=c[s][s]-j,j<=0)break;c[s][s]=Math.sqrt(j)}else{for(h=1;h<=m;h=h+1){for(y=c[h][s],v=1;v<h;v=v+1)y=y-c[v][s]*c[v][h];y=y/c[h][h],c[h][s]=y,j=j+y*y}if(j=c[s][s]-j,j<=0)break;c[s][s]=Math.sqrt(j)}a[1]=0}}function t(c,f,l,a,v,s,m,h,y,j,w,b,d,M,x,S){var p,_,F,V,U,P,L,D,R,q,N,E,$,rr,O,I,W,G,Q,X,Z,J,z,K,ir,H,Y;$=Math.min(a,j),F=2*a+$*($+5)/2+2*j+1,K=1e-60;do K=K+K,ir=1+.1*K,H=1+.2*K;while(ir<=1||H<=1);for(p=1;p<=a;p=p+1)x[p]=f[p];for(p=a+1;p<=F;p=p+1)x[p]=0;for(p=1;p<=j;p=p+1)b[p]=0;if(U=[],S[1]===0){if(i(c,l,a,U),U[1]!==0){S[1]=2;return}o(c,l,a,f),r(c,l,a)}else{for(_=1;_<=a;_=_+1)for(v[_]=0,p=1;p<=_;p=p+1)v[_]=v[_]+c[p][_]*f[p];for(_=1;_<=a;_=_+1)for(f[_]=0,p=_;p<=a;p=p+1)f[_]=f[_]+c[_][p]*v[p]}for(s[1]=0,_=1;_<=a;_=_+1)for(v[_]=f[_],s[1]=s[1]+x[_]*v[_],x[_]=0,p=_+1;p<=a;p=p+1)c[p][_]=0;for(s[1]=-s[1]/2,S[1]=0,L=a,D=L+a,N=D+$,R=N+$+1,q=R+$*($+1)/2,rr=q+j,p=1;p<=j;p=p+1){for(I=0,_=1;_<=a;_=_+1)I=I+m[_][p]*m[_][p];x[rr+p]=Math.sqrt(I)}d=0,M[1]=0,M[2]=0;function or(){for(M[1]=M[1]+1,F=q,p=1;p<=j;p=p+1){for(F=F+1,I=-h[p],_=1;_<=a;_=_+1)I=I+m[_][p]*v[_];if(Math.abs(I)<K&&(I=0),p>w)x[F]=I;else if(x[F]=-Math.abs(I),I>0){for(_=1;_<=a;_=_+1)m[_][p]=-m[_][p];h[p]=-h[p]}}for(p=1;p<=d;p=p+1)x[q+b[p]]=0;for(E=0,O=0,p=1;p<=j;p=p+1)x[q+p]<O*x[rr+p]&&(E=p,O=x[q+p]/x[rr+p]);return E===0?999:0}function tr(){for(p=1;p<=a;p=p+1){for(I=0,_=1;_<=a;_=_+1)I=I+c[_][p]*m[_][E];x[p]=I}for(V=L,p=1;p<=a;p=p+1)x[V+p]=0;for(_=d+1;_<=a;_=_+1)for(p=1;p<=a;p=p+1)x[V+p]=x[V+p]+c[p][_]*x[_];for(J=!0,p=d;p>=1;p=p-1){for(I=x[p],F=R+p*(p+3)/2,V=F-p,_=p+1;_<=d;_=_+1)I=I-x[F]*x[D+_],F=F+_;if(I=I/x[V],x[D+p]=I,b[p]<w||I<0)break;J=!1,P=p}if(!J)for(W=x[N+P]/x[D+P],p=1;p<=d&&!(b[p]<w||x[D+p]<0);p=p+1)O=x[N+p]/x[D+p],O<W&&(W=O,P=p);for(I=0,p=L+1;p<=L+a;p=p+1)I=I+x[p]*x[p];if(Math.abs(I)<=K){if(J)return S[1]=1,999;for(p=1;p<=d;p=p+1)x[N+p]=x[N+p]-W*x[D+p];return x[N+d+1]=x[N+d+1]+W,700}else{for(I=0,p=1;p<=a;p=p+1)I=I+x[L+p]*m[p][E];for(G=-x[q+E]/I,z=!0,J||W<G&&(G=W,z=!1),p=1;p<=a;p=p+1)v[p]=v[p]+G*x[L+p],Math.abs(v[p])<K&&(v[p]=0);for(s[1]=s[1]+G*I*(G/2+x[N+d+1]),p=1;p<=d;p=p+1)x[N+p]=x[N+p]-G*x[D+p];if(x[N+d+1]=x[N+d+1]+G,z){for(d=d+1,b[d]=E,F=R+(d-1)*d/2+1,p=1;p<=d-1;p=p+1)x[F]=x[p],F=F+1;if(d===a)x[F]=x[a];else{for(p=a;p>=d+1&&!(x[p]===0||(Q=Math.max(Math.abs(x[p-1]),Math.abs(x[p])),X=Math.min(Math.abs(x[p-1]),Math.abs(x[p])),x[p-1]>=0?O=Math.abs(Q*Math.sqrt(1+X*X/(Q*Q))):O=-Math.abs(Q*Math.sqrt(1+X*X/(Q*Q))),Q=x[p-1]/O,X=x[p]/O,Q===1));p=p-1)if(Q===0)for(x[p-1]=X*O,_=1;_<=a;_=_+1)O=c[_][p-1],c[_][p-1]=c[_][p],c[_][p]=O;else for(x[p-1]=O,Z=X/(1+Q),_=1;_<=a;_=_+1)O=Q*c[_][p-1]+X*c[_][p],c[_][p]=Z*(c[_][p-1]+O)-c[_][p],c[_][p-1]=O;x[F]=x[d]}}else{for(I=-h[E],_=1;_<=a;_=_+1)I=I+v[_]*m[_][E];if(E>w)x[q+E]=I;else if(x[q+E]=-Math.abs(I),I>0){for(_=1;_<=a;_=_+1)m[_][E]=-m[_][E];h[E]=-h[E]}return 700}}return 0}function ur(){if(F=R+P*(P+1)/2+1,V=F+P,x[V]===0||(Q=Math.max(Math.abs(x[V-1]),Math.abs(x[V])),X=Math.min(Math.abs(x[V-1]),Math.abs(x[V])),x[V-1]>=0?O=Math.abs(Q*Math.sqrt(1+X*X/(Q*Q))):O=-Math.abs(Q*Math.sqrt(1+X*X/(Q*Q))),Q=x[V-1]/O,X=x[V]/O,Q===1))return 798;if(Q===0){for(p=P+1;p<=d;p=p+1)O=x[V-1],x[V-1]=x[V],x[V]=O,V=V+p;for(p=1;p<=a;p=p+1)O=c[p][P],c[p][P]=c[p][P+1],c[p][P+1]=O}else{for(Z=X/(1+Q),p=P+1;p<=d;p=p+1)O=Q*x[V-1]+X*x[V],x[V]=Z*(x[V-1]+O)-x[V],x[V-1]=O,V=V+p;for(p=1;p<=a;p=p+1)O=Q*c[p][P]+X*c[p][P+1],c[p][P+1]=Z*(c[p][P]+O)-c[p][P+1],c[p][P]=O}return 0}function er(){for(V=F-P,p=1;p<=P;p=p+1)x[V]=x[F],F=F+1,V=V+1;return x[N+P]=x[N+P+1],b[P]=b[P+1],P=P+1,P<d?797:0}function nr(){return x[N+d]=x[N+d+1],x[N+d+1]=0,b[d]=0,d=d-1,M[2]=M[2]+1,0}for(Y=0;;){if(Y=or(),Y===999)return;for(;Y=tr(),Y!==0;){if(Y===999)return;if(Y===700)if(P===d)nr();else{for(;ur(),Y=er(),Y===797;);nr()}}}}function u(c,f,l,a,v,s){c=n(c),f=n(f),l=n(l);var m,h,y,j,w,b=[],d=[],M=[],x=[],S=[],p;if(v=v||0,s=s?n(s):[void 0,0],a=a?n(a):[],h=c.length-1,y=l[1].length-1,!a)for(m=1;m<=y;m=m+1)a[m]=0;for(m=1;m<=y;m=m+1)d[m]=0;for(j=0,w=Math.min(h,y),m=1;m<=h;m=m+1)M[m]=0;for(b[1]=0,m=1;m<=2*h+w*(w+5)/2+2*y+1;m=m+1)x[m]=0;for(m=1;m<=2;m=m+1)S[m]=0;return t(c,f,h,h,M,b,l,a,h,y,v,d,j,S,x,s),p="",s[1]===1&&(p="constraints are inconsistent, no solution!"),s[1]===2&&(p="matrix D in quadratic function is not positive definite!"),{solution:e(M),value:e(b),unconstrained_solution:e(f),iterations:e(S),iact:e(d),message:p}}g.solveQP=u})(numeric),numeric.svd=function g(n){var e,r=numeric.epsilon,o=1e-64/r,i=50,t=0,u=0,c=0,f=0,l=0,a=numeric.clone(n),v=a.length,s=a[0].length;if(v<s)throw"Need more rows than columns";var m=new Array(s),h=new Array(s);for(u=0;u<s;u++)m[u]=h[u]=0;var y=numeric.rep([s,s],0);function j(U,P){return U=Math.abs(U),P=Math.abs(P),U>P?U*Math.sqrt(1+P*P/U/U):P==0?U:P*Math.sqrt(1+U*U/P/P)}var w=0,b=0,d=0,M=0,x=0,S=0,p=0;for(u=0;u<s;u++){for(m[u]=b,p=0,l=u+1,c=u;c<v;c++)p+=a[c][u]*a[c][u];if(p<=o)b=0;else for(w=a[u][u],b=Math.sqrt(p),w>=0&&(b=-b),d=w*b-p,a[u][u]=w-b,c=l;c<s;c++){for(p=0,f=u;f<v;f++)p+=a[f][u]*a[f][c];for(w=p/d,f=u;f<v;f++)a[f][c]+=w*a[f][u]}for(h[u]=b,p=0,c=l;c<s;c++)p=p+a[u][c]*a[u][c];if(p<=o)b=0;else{for(w=a[u][u+1],b=Math.sqrt(p),w>=0&&(b=-b),d=w*b-p,a[u][u+1]=w-b,c=l;c<s;c++)m[c]=a[u][c]/d;for(c=l;c<v;c++){for(p=0,f=l;f<s;f++)p+=a[c][f]*a[u][f];for(f=l;f<s;f++)a[c][f]+=p*m[f]}}x=Math.abs(h[u])+Math.abs(m[u]),x>M&&(M=x)}for(u=s-1;u!=-1;u+=-1){if(b!=0){for(d=b*a[u][u+1],c=l;c<s;c++)y[c][u]=a[u][c]/d;for(c=l;c<s;c++){for(p=0,f=l;f<s;f++)p+=a[u][f]*y[f][c];for(f=l;f<s;f++)y[f][c]+=p*y[f][u]}}for(c=l;c<s;c++)y[u][c]=0,y[c][u]=0;y[u][u]=1,b=m[u],l=u}for(u=s-1;u!=-1;u+=-1){for(l=u+1,b=h[u],c=l;c<s;c++)a[u][c]=0;if(b!=0){for(d=a[u][u]*b,c=l;c<s;c++){for(p=0,f=l;f<v;f++)p+=a[f][u]*a[f][c];for(w=p/d,f=u;f<v;f++)a[f][c]+=w*a[f][u]}for(c=u;c<v;c++)a[c][u]=a[c][u]/b}else for(c=u;c<v;c++)a[c][u]=0;a[u][u]+=1}for(r=r*M,f=s-1;f!=-1;f+=-1)for(var _=0;_<i;_++){var F=!1;for(l=f;l!=-1;l+=-1){if(Math.abs(m[l])<=r){F=!0;break}if(Math.abs(h[l-1])<=r)break}if(!F){t=0,p=1;var V=l-1;for(u=l;u<f+1&&(w=p*m[u],m[u]=t*m[u],!(Math.abs(w)<=r));u++)for(b=h[u],d=j(w,b),h[u]=d,t=b/d,p=-w/d,c=0;c<v;c++)x=a[c][V],S=a[c][u],a[c][V]=x*t+S*p,a[c][u]=-x*p+S*t}if(S=h[f],l==f){if(S<0)for(h[f]=-S,c=0;c<s;c++)y[c][f]=-y[c][f];break}if(_>=i-1)throw"Error: no convergence.";for(M=h[l],x=h[f-1],b=m[f-1],d=m[f],w=((x-S)*(x+S)+(b-d)*(b+d))/(2*d*x),b=j(w,1),w<0?w=((M-S)*(M+S)+d*(x/(w-b)-d))/M:w=((M-S)*(M+S)+d*(x/(w+b)-d))/M,t=1,p=1,u=l+1;u<f+1;u++){for(b=m[u],x=h[u],d=p*b,b=t*b,S=j(w,d),m[u-1]=S,t=w/S,p=d/S,w=M*t+b*p,b=-M*p+b*t,d=x*p,x=x*t,c=0;c<s;c++)M=y[c][u-1],S=y[c][u],y[c][u-1]=M*t+S*p,y[c][u]=-M*p+S*t;for(S=j(w,d),h[u-1]=S,t=w/S,p=d/S,w=t*b+p*x,M=-p*b+t*x,c=0;c<v;c++)x=a[c][u-1],S=a[c][u],a[c][u-1]=x*t+S*p,a[c][u]=-x*p+S*t}m[l]=0,m[f]=w,h[f]=M}for(u=0;u<h.length;u++)h[u]<r&&(h[u]=0);for(u=0;u<s;u++)for(c=u-1;c>=0;c--)if(h[c]<h[u]){for(t=h[c],h[c]=h[u],h[u]=t,f=0;f<a.length;f++)e=a[f][u],a[f][u]=a[f][c],a[f][c]=e;for(f=0;f<y.length;f++)e=y[f][u],y[f][u]=y[f][c],y[f][c]=e;u=c}return{U:a,S:h,V:y}}})(numeric1_2_6)),numeric1_2_6}var numeric1_2_6Exports=requireNumeric1_2_6(),numeric=getDefaultExportFromCjs(numeric1_2_6Exports);function buildNeighborTable(g,n){const e=Array.from({length:n},()=>new Set);for(let r=0;r<g.length;r+=3){const o=g[r+0],i=g[r+1],t=g[r+2];e[o].add(i),e[o].add(t),e[i].add(o),e[i].add(t),e[t].add(o),e[t].add(i)}return e.map(r=>Array.from(r))}function buildOppositeVtxIdOfEdge(g){const n=new Map;for(let e=0;e<g.length;e+=3){const r=g[e+0],o=g[e+1],i=g[e+2];n.set(`${r}-${o}`,i),n.set(`${o}-${i}`,r),n.set(`${i}-${r}`,o)}return n}function cotangentAtK(g,n,e,r){const o=g[r*2+0],i=g[r*2+1],t=g[n*2+0],u=g[n*2+1],c=g[e*2+0],f=g[e*2+1],l=o-t,a=i-u,v=o-c,s=i-f,m=l*v+a*s,h=Math.abs(l*s-a*v);if(h<1e-12)return 0;const y=m/h;return Math.max(y,0)}function buildWij(g,n,e){const r=new Map;for(let o=0;o<n.length;o++)for(const i of n[o]){const t=`${o}-${i}`,u=`${i}-${o}`;let c;const f=e.get(t);f!==void 0&&(c=cotangentAtK(g,o,i,f));let l;const a=e.get(u);a!==void 0&&(l=cotangentAtK(g,o,i,a));let v;c===void 0?v=l??0:l===void 0?v=c:v=.5*(c+l),r.set(t,v),r.set(u,v)}return r}function buildMatrixL(g,n){const e=n.length,r=Array.from({length:e},()=>[]);for(let o=0;o<e;o++){let i=0;for(const t of n[o]){const u=g.get(`${o}-${t}`)??0;!Number.isFinite(u)||u<=0||(r[o].push([t,-u]),i+=u)}r[o].push([o,i])}return r}function calcRotationMatrices2D(g,n,e,r){const o=e.length,i=new Array(o);for(let t=0;t<o;t++){let u=0,c=0,f=0,l=0;const a=g[t*2+0],v=g[t*2+1],s=n[t*2+0],m=n[t*2+1];for(const _ of e[t]){const F=r.get(`${t}-${_}`)??0;if(!Number.isFinite(F)||F<=0)continue;const V=g[_*2+0],U=g[_*2+1],P=n[_*2+0],L=n[_*2+1],D=V-a,R=U-v,q=P-s,N=L-m;u+=F*D*q,c+=F*D*N,f+=F*R*q,l+=F*R*N}const h=[[u,c],[f,l]],y=Math.max(Math.abs(u),Math.abs(c),Math.abs(f),Math.abs(l),1);h[0][0]+=y*1e-6,h[1][1]+=y*1e-6;const j=numeric.svd(h),w=j.U,b=j.V,d=numeric.det(w),M=numeric.det(b);d*M<0&&(w[0][1]*=-1,w[1][1]*=-1);const x=numeric.transpose(w),S=numeric.dot(b,x),p=numeric.det(S);Number.isFinite(p)?i[t]=[S[0][0],S[0][1],S[1][0],S[1][1]]:i[t]=[1,0,0,1]}return i}function mat2MulVec2(g,n,e){return[g[0]*n+g[1]*e,g[2]*n+g[3]*e]}function mat2Add(g,n){return[g[0]+n[0],g[1]+n[1],g[2]+n[2],g[3]+n[3]]}function mat2Scale(g,n){return[g[0]*n,g[1]*n,g[2]*n,g[3]*n]}function buildB(g,n,e,r,o,i,t){const u=o.length,c=new Float64Array(u),f=new Float64Array(u);for(let l=0;l<u;l++){const a=o[l],v=n[a],s=g[a*2+0],m=g[a*2+1];let h=0,y=0;for(const j of e[a]){const w=r.get(`${a}-${j}`)??0;if(!Number.isFinite(w)||w<=0)continue;const b=n[j],d=mat2Scale(mat2Add(v,b),.5),M=g[j*2+0],x=g[j*2+1],S=s-M,p=m-x,[_,F]=mat2MulVec2(d,S,p);h+=w*_,y+=w*F}c[l]=h,f[l]=y}return{bx:c,by:f}}function buildReducedSystem(g,n,e,r,o,i){const t=n.length,u=new Array(t),c=new Array(t);for(let f=0;f<t;f++){const l=n[f],a=g[l],v=[],s=[];for(const[m,h]of a){const y=e[m];y!==-1?(v.push(y),s.push(h)):(r[f]-=h*i[m*2+0],o[f]-=h*i[m*2+1])}u[f]=Int32Array.from(v),c[f]=Float64Array.from(s)}return{cols:u,vals:c}}function matVecSparse(g,n,e){for(let r=0;r<g.cols.length;r++){let o=0;const i=g.cols[r],t=g.vals[r];for(let u=0;u<i.length;u++)o+=t[u]*n[i[u]];e[r]=o}}function dot(g,n){let e=0;for(let r=0;r<g.length;r++)e+=g[r]*n[r];return e}function axpy(g,n,e){for(let r=0;r<n.length;r++)e[r]+=g*n[r]}function xpay(g,n,e){for(let r=0;r<n.length;r++)e[r]=n[r]+g*e[r]}function conjugateGradient(g,n,e,r,o){const i=e.length,t=new Float64Array(i),u=new Float64Array(i),c=new Float64Array(i);matVecSparse(g,n,c);for(let a=0;a<i;a++)t[a]=e[a]-c[a],u[a]=t[a];let f=dot(t,t);const l=o*o;if(f<l)return n;for(let a=0;a<r;a++){matVecSparse(g,u,c);const v=dot(u,c),s=f/Math.max(1e-30,v);axpy(s,u,n),axpy(-s,c,t);const m=dot(t,t);if(m<l)break;const h=m/Math.max(1e-30,f);xpay(h,t,u),f=m}return n}function applyConstraints(g,n,e){for(let r=0;r<n.length;r++){const o=n[r];g[o*2+0]=e[r*2+0],g[o*2+1]=e[r*2+1]}}self.onmessage=g=>{const n=g.data;if(n.type==="solve")try{const e=n.vertices.length/2,r=buildNeighborTable(n.faces,e),o=buildOppositeVtxIdOfEdge(n.faces),i=buildWij(n.vertices,r,o),t=buildMatrixL(i,r),u=new Uint8Array(e);for(let s=0;s<n.constraints.length;s++)u[n.constraints[s]]=1;const c=[];for(let s=0;s<e;s++)u[s]||c.push(s);const f=new Int32Array(e);f.fill(-1);for(let s=0;s<c.length;s++)f[c[s]]=s;const l=n.vertices,a=new Float64Array(l);applyConstraints(a,n.constraints,n.constraintPositions);for(let s=0;s<n.options.iterations;s++){const m=calcRotationMatrices2D(l,a,r,i),{bx:h,by:y}=buildB(l,m,r,i,c,f,a),j=buildReducedSystem(t,c,f,h,y,a),w=new Float64Array(c.length),b=new Float64Array(c.length);for(let d=0;d<c.length;d++){const M=c[d];w[d]=a[M*2+0],b[d]=a[M*2+1]}conjugateGradient(j,w,h,n.options.cgMaxIterations,n.options.cgTolerance),conjugateGradient(j,b,y,n.options.cgMaxIterations,n.options.cgTolerance);for(let d=0;d<c.length;d++){const M=c[d];a[M*2+0]=w[d],a[M*2+1]=b[d]}applyConstraints(a,n.constraints,n.constraintPositions)}const v={id:n.id,type:"result",deformedVertices:a,iterations:n.options.iterations};self.postMessage(v,[a.buffer])}catch(e){const r=e instanceof Error?e.message:String(e),o={id:n.id,type:"error",message:r};self.postMessage(o)}}})();
